//archivo de configuración
let JSON_CUENTO = {
    nombre: 'El flautista de Hamelin',
    tipo: 'Cuento',
    descripcion:
      '“El flautista de Hamelin” Narra la historia de un pueblo que se encuentra atestado de ratas, razón que desespera a todos sus habitantes. Un día aparece un joven que ofrece solucionar de una vez por todas la gran plaga de Hamelin, pero a cambio exige cierta compensación por su trabajo, el pueblo acepta, y el flautista con tres tonadas de su instrumento logra que todas las ratas se marchen del pueblo. El problema surge cuando el tacaño alcalde de Hamelin se reúsa pagar al joven la suma que le correspondía. Ahí es cuando el flautista decide tomar justicia por sus manos y reclamar la suma hipnotizando a los niños del pueblo y llevándolos hacia una cueva mágica, hasta recibir el pago prometido. Este relato es una adaptación libre basada en una leyenda popular alemana, atribuida a los hermanos Grimm en 1816. La leyenda registra un suceso oscuro, ocurrido en Alemania en 1284, donde se secuestraron a niños en el pueblo de Hamelin. La principal fuente que patenta este relato oral se encuentra en el vitral de la iglesia de Hamelin elaborado en el 1300 d.c. ',
    creditos: [
      ['Adaptación:', 'Copec'],
      ['Ilustraciones:', 'Copec'],
      ['Narración:', 'Nicole Castillo Ramírez'],
      ['Arreglos musicales:', 'Copec y Entrelíneas'],
      [
        'Edición a cargo de:',
        'Copec',
      ],
      ['Montaje y desarrollo web:', 'Agencia Match'],
      [
        'Créditos de sonidos:',
        "Revise detalles <a href='#' target='_blank'>aquí</a>",
      ],
    ],
    ID: 0,
    imagenes: [
      'img/elFlautistaDeHamelin/esc_0_fondo.jpg',
      'img/elFlautistaDeHamelin/esc_1_fondo.jpg',
      'img/elFlautistaDeHamelin/esc_2_fondo.jpg',
      'img/elFlautistaDeHamelin/esc_3_fondo.jpg',
      'img/elFlautistaDeHamelin/esc_4_fondo.jpg',
      'img/elFlautistaDeHamelin/esc_5_fondo.jpg',
      'img/elFlautistaDeHamelin/esc_6_fondo.jpg',
      'img/elFlautistaDeHamelin/esc_7_fondo.jpg',
    ],
    fx_sonido: [
      {
        nombre: 'alcalde_codicioso',
        url: 'audio/elFlautistaDeHamelin/fx/alcalde_codicioso.mp3',
      },
      {
        nombre: 'amigos_codiciosos',
        url: 'audio/elFlautistaDeHamelin/fx/amigos_codiciosos.mp3',
      },
      {
        nombre: 'chapuzon_de_ratas',
        url: 'audio/elFlautistaDeHamelin/fx/chapuzon_de_ratas.mp3',
      },
      {
        nombre: 'copia_de_mercado',
        url: 'audio/elFlautistaDeHamelin/fx/copia_de_mercado.mp3',
      },
      {
        nombre: 'ciudad_de_ratas',
        url: 'audio/elFlautistaDeHamelin/fx/ciudad_de_ratas.mp3',
      },
      {
        nombre: 'ciudad_de_ratas_copia',
        url: 'audio/elFlautistaDeHamelin/fx/ciudad_de_ratas_copia.mp3',
      },
      {
        nombre: 'copia_de_buho',
        url: 'audio/elFlautistaDeHamelin/fx/copia_de_buho.mp3',
      },
      {
        nombre: 'copia_de_copia_de_copia_de_musica_flauta_mágica',
        url: 'audio/elFlautistaDeHamelin/fx/copia_de_copia_de_copia_de_musica_flauta_mágica.mp3',
      },
      {
        nombre: 'copia_de_copia_de_musica_flauta_magica',
        url: 'audio/elFlautistaDeHamelin/fx/copia_de_copia_de_musica_flauta_magica.mp3',
      },
      {
        nombre: 'copia_de_musica_flauta_magica',
        url: 'audio/elFlautistaDeHamelin/fx/copia_de_musica_flauta_magica.mp3',
      },
      {
        nombre: 'copia_de_musica_flauta_magica_Esc06',
        url: 'audio/elFlautistaDeHamelin/fx/copia_de_musica_flauta_magica_Esc06.mp3',
      },
      {
        nombre: 'copia_de_musica_flauta_magica_Esc04',
        url: 'audio/elFlautistaDeHamelin/fx/copia_de_musica_flauta_magica_Esc04.mp3',
      },
      {
        nombre: 'copia_de_musica_flauta_magica_esc_08',
        url: 'audio/elFlautistaDeHamelin/fx/copia_de_musica_flauta_magica_esc_08.mp3',
      },
      {
        nombre: 'copia_de_musica_flauta_magica_Esc01',
        url: 'audio/elFlautistaDeHamelin/fx/copia_de_musica_flauta_magica_Esc01.mp3',
      },
      {
        nombre: 'cueva_magica',
        url: 'audio/elFlautistaDeHamelin/fx/cueva_magica.mp3',
      },
      {
        nombre: 'flauta_solucion',
        url: 'audio/elFlautistaDeHamelin/fx/flauta_solucion.mp3',
      },
      {
        nombre: 'flauta_solucion_2',
        url: 'audio/elFlautistaDeHamelin/fx/flauta_solucion_2.mp3',
      },
      {
        nombre: 'flautista_desilucionado',
        url: 'audio/elFlautistaDeHamelin/fx/flautista_desilusionado.mp3',
      },
      {
        nombre: 'musica_flauta_magica',
        url: 'audio/elFlautistaDeHamelin/fx/musica_flauta_magica.mp3',
      },
      {
        nombre: 'niño_durmiendo_1',
        url: 'audio/elFlautistaDeHamelin/fx/niño_durmiendo_1.mp3',
      },
      {
        nombre: 'niña_durmiendo_2',
        url: 'audio/elFlautistaDeHamelin/fx/niña_durmiendo_2.mp3',
      },
      {
        nombre: 'publico_asombrado',
        url: 'audio/elFlautistaDeHamelin/fx/publico_asombrado.mp3',
      },
      {
        nombre: 'publico_disgustado',
        url: 'audio/elFlautistaDeHamelin/fx/publico_disgustado.mp3',
      },
      {
        nombre: 'publico_disgustado_copia',
        url: 'audio/elFlautistaDeHamelin/fx/publico_disgustado_copia.mp3',
      },
      {
        nombre: 'rio',
        url: 'audio/elFlautistaDeHamelin/fx/rio.mp3',
      },
      {
        nombre: 'voz_de_rata_1',
        url: 'audio/elFlautistaDeHamelin/fx/voz_de_rata_1.mp3',
      },
      {
        nombre: 'voz_de_rata_2',
        url: 'audio/elFlautistaDeHamelin/fx/voz_de_rata_2.mp3',
      }
    ],
    n_escena: 0,
    escenas: [
      {
        nombre: 'Escena 1',
        miniatura: 'img/elFlautistaDeHamelin/mini_1.jpg',
        audio: 'audio/elFlautistaDeHamelin/escena_01.mp3',
        parrafos: [
          {
            texto:
              'Hamelin era una ciudad muy hermosa,<br> llena de torres y puentes, árboles y flores.',
            tiempo: [0, 6.4, 14.0],
          },
          {
            texto:
              'Sus habitantes vivían felices pues nada les faltaba.',
            tiempo: [6.9, 10.3, 0.5],
          },
          {
            texto:
              'Pero un día las ratas invadieron la ciudad mordisqueando y comiéndose todo.',
            tiempo: [10.8, 16.7,0],
          }
        ],
      },
      {
        nombre: 'Escena 2',
        miniatura: 'img/elFlautistaDeHamelin/mini_2.jpg',
        audio: 'audio/elFlautistaDeHamelin/escena_02.mp3',
        parrafos: [
          {
            texto:
              'Los habitantes de Hamelin estaban desesperados: <br> era la plaga más grande que habían visto jamás.',
            tiempo: [0, 7.3, 0.5],
          },
          {
            texto: '¡Ayuda, señor alcalde! <br> gritaba el pueblo reunido en la plaza',
            tiempo: [7.8, 12.2, 0.5],
          },
          {
            texto: '¡No podemos vivir rodeados de ratas!',
            tiempo: [12.7, 15.2, 0.5],
          }
        ],
      },
      {
        nombre: 'Escena 3',
        miniatura: 'img/elFlautistaDeHamelin/mini_3.jpg',
        audio: 'audio/elFlautistaDeHamelin/escena_03.mp3',
        parrafos: [
          {
            texto:
              'Entre la multitud apareció un joven con una flauta en la mano. <br> "Yo puedo ayudarlos", dijo.',
            tiempo: [0, 7.6, 0.5]
          },
          {
            texto: '"A cambio pido un puñado de monedas de oro" ',
            tiempo: [8.1, 11.0, 0.5]
          },
          {
            texto: 'El alcalde, estrechando su mano, aceptó el trato.',
            tiempo: [12, 15.7, 1.0]
          }
        ],
      },
      {
        nombre: 'Escena 4',
        miniatura: 'img/elFlautistaDeHamelin/mini_4.jpg',
        audio: 'audio/elFlautistaDeHamelin/escena_04.mp3',
        parrafos: [
          {
            texto:
              'Solo tres notas bastaron para que todas las ratas levantaran sus orejas <br> y comenzaran a seguir al joven.',
            tiempo: [0, 7.5, 2]
          },
  
          {
            texto: 'El mágico flautista caminó hacia el río y las ratas <br>lo siguieron como si estuvieran hechizadas.',
            tiempo: [8.5, 15.1, 1.0]
          },
  
          {
            texto: 'En poco tiempo, la ciudad quedó libre de ratas. ',
            tiempo: [16.1, 20.0, 1.0] // 16,47,1
          },
          {
            texto: '',
            tiempo: [20.5, 47.5, 0.5] // 16,47,1
          }
        ],
      },
      {
        nombre: 'Escena 5',
        miniatura: 'img/elFlautistaDeHamelin/mini_5.jpg',
        audio: 'audio/elFlautistaDeHamelin/escena_05.mp3',
        parrafos: [
          {
            texto:
              'El alcalde, que era un hombre muy avaro, le dijo al flautista:',
            tiempo: [0, 4.7, 0.5],
          },
          {
            texto:
              'Tu trabajo fue muy fácil, por lo que solamente te daré una moneda.',
            tiempo: [5.7, 10.0, 1.0],
          },
          {
            texto:
              'El joven le contestó: <br> Si no cumples con tu palabra, lo lamentarás.',
            tiempo: [11.0, 17.0, 1.0],
          }
        ],
      },
      {
        nombre: 'Escena 6',
        miniatura: 'img/elFlautistaDeHamelin/mini_6.jpg',
        audio: 'audio/elFlautistaDeHamelin/escena_06.mp3',
        parrafos: [
          {
            texto: 'El alcalde se rehusó a cumplir con su palabra.',
            tiempo: [0, 3.4, 0.5],
          },
          {
            texto:
              'El joven pidió ayuda a los vecinos, que lo ignoraron, <br> pues el problema de las ratas ya estaba solucionado.',
            tiempo: [4.1, 10.6, 0.7],
          },
          {
            texto:
              'El flautista salió entonces por las calles de Hamelin tocando su flauta dulcemente.',
            tiempo: [11.6, 17.6, 1.0],
          },
          {
            texto:
              'Al oírla, todos los niños de la ciudad <br> lo siguieron como hipnotizados con su música.',
            tiempo: [18.6, 24.5, 1.0], // 22.7 => 17.6
          }
        ],
      },
      {
        nombre: 'Escena 7',
        miniatura: 'img/elFlautistaDeHamelin/mini_7.jpg',
        audio: 'audio/elFlautistaDeHamelin/escena_07.mp3',
        parrafos: [
          {
            texto:
              'Los niños marcharon tras el flautista hasta una cueva mágica <br> que había en las montañas.',
            tiempo: [0, 5.8, 0.5],
          },
          {
            texto: 'Uno tras otro los niños fueron entrando en la cueva <br> hasta que la entrada se cerró. ',
            tiempo: [6.3, 11.6, 0.5],
          },
          {
            texto: 'El último niño, que era muy pequeño, no alcanzó a entrar <br> y pudo volver hasta el pueblo a contar a todos lo sucedido.',
            tiempo: [12.1, 20.3, 0.5]// 20.3 => 12.9
          }
        ],
      },
      {
        nombre: 'Escena 8',
        miniatura: 'img/elFlautistaDeHamelin/mini_8.jpg',
        audio: 'audio/elFlautistaDeHamelin/escena_08.mp3',
        parrafos: [
          {
            texto:'El alcalde y los vecinos, arrepentidos, <br> comprendieron que debían cumplir su palabra.',
            tiempo: [0, 6.4, 10.0],
          },
          {
            texto: 'Así lo hicieron, y después de un largo tiempo de dolor y angustia.',
            tiempo: [7.4, 12.0, 1.0]
          },
          {
            texto: 'Los niños por fin pudieron reunirse con sus familias en Hamelin.',
            tiempo: [13.0, 17.8, 1.0]
          },
          {
            texto: 'Y colorín colorado este cuento se ha acabado',
            tiempo: [18.3, 22.2, 0.5]
          }
        ],
      },
    ],
  };
  //CREA Y GESTIONA TODAS LAS ANIMACIONES DEL CUENTO, TIENE FUNCIONES Y UN main_tl => timeline principal
  //timeline, es secuencia de de elementos => animaciones, funciones y timelines en un periodo de tiempo.
  let ANIM = {
    /* ↓↓↓↓↓ HOLA CATA - COPIA DESDE LA LÍNEA SIGUIENTE ↓↓↓↓↓ */
    main_tl: undefined,
    creapartes: () => {
      // PONER ACÁ LO QUE SE VAYA A CREAR "ON THE FLY"
    },
    //reducir volumen
    fadeVolume: (cual, desde = 1, hasta = 0.2, t = 1) => {
      //nombre_sonido, volumen_inicio, volumen_final, tiempoDeFade
      let o = { vol: desde };
      let fade = new TimelineMax({
        onUpdate: function () {
          Player.cambiaVolume(cual, o.vol);
        },
      });
      //reducir volumen
      fade.to(o, t, { vol: hasta });
      fade.play(); //ejecutar el fade
    },
  
    arrWaitSounds: [], //contenedor de timelines, contraladores del sonido "especial"
    waitForSound: (
      cual,
      waitFor = 4,
      cuantoDura = 14,
      cuantasVeces = 1,
      cuantoDejoAlFinal = 0,
      volume = 1,
      fade = false,
      fadeFrom = 12,
      volFadeTo = 0
    ) => {
      if (!ANIM[`wait_sound_${cual}`]) {
        //no existe o es nuevo
        ANIM[`wait_sound_${cual}`] = new TimelineMax({
          repeat: cuantasVeces - 1,
        }); // reproducción inicial + 1 repetición => condiciona a repetir  n veces exacto
        //
        let o = { val: 0 };
        let waitTL = `+=${waitFor}`; //4 segundos despues de la TimeLine
        ANIM[`wait_sound_${cual}`]
  
          .addLabel('inicio') //inicio
          .addCallback(function () {
            Player.playSoundFX(cual); //ejecutar el efecto de sonido "musica_" inifinitas veces
            Player.cambiaVolume(cual, volume);
          }, waitTL)
          .to(o, cuantoDura + cuantoDejoAlFinal, { val: 100 })
          .addLabel('final'); //final
  
        //            ANIM[`wait_sound_${cual}`].add(TweenMax.to(o, cuantoDura+cuantoDejoAlFinal,{val:100}),waitFor);
  
        if (fade) {
          ANIM[`wait_sound_${cual}`].addCallback(function () {
            ANIM.fadeVolume(cual, volume, volFadeTo, cuantoDura - fadeFrom);
          }, waitFor + fadeFrom);
        }
  
        ANIM.arrWaitSounds.push(ANIM[`wait_sound_${cual}`]);
      }
      ANIM[`wait_sound_${cual}`].play(0);
    },
    
    pauseWaitSound: () => {
      ANIM.arrWaitSounds.map((item, i) => {
        item.pause();
      });
    },
  
    pauseAnimaciones: () => {
      try {
        ANIM.anim_interact_7_feliz.pause(0);
      } catch (err) {}
    },
  
    init: () => {
        ANIM.creapartes();
          
        Player.creaMainTL();

        let preAnimacion1 = new TimelineMax();
        preAnimacion1
          
        ANIM.main_tl.add(preAnimacion1,'0_0-=0');

        let preAnimacion1_2 = new TimelineMax();
        preAnimacion1_2
            //RATA 1
            .from('#escena_00 .rata1OjoEsc00', 1.3, {duration:2, ease: Power4.easeOut,repeat:-1}, 0)
            .to('#escena_00 .rata1ColaEsc00', 2, {rotation:-20, ease:"wiggle",yoyo:true,repeat:-1}, 0)
            .set("#escena_00 .rata1CabezaEsc00", {autoAlpha:1})
            .set("#escena_00 .rata1CuerpoEsc00", {autoAlpha:1})
            .set("#escena_00 .rata1ColaEsc00", {autoAlpha:1, transformOrigin:"center top",repeat:-1})
            //RATA 2
            .fromTo('#escena_00 .rata2Esc00',2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2),repeat:-1},0)
            .set("#escena_00 .rata2ColaEsc00", {transformOrigin:"center bottom"},0)
            .to('#escena_00 .rata2ColaEsc00', 2, {rotation:8, ease:"wiggle",yoyo:true,repeat:-1},0)
            .set("#escena_00 .rata2Esc00", {autoAlpha:1})
            .set("#escena_00 .rata2ColaEsc00", {autoAlpha:1})
            //RATA 3
            .from('#escena_00 .rata3OjoEsc00', 1.3, {duration:2, ease: Power4.easeOut,repeat:-1},0)
            .to('#escena_00 .rata3ColaEsc00', 2, {rotation:165, ease:"wiggle",yoyo:true,repeat:-1},0)
            .set("#escena_00 .rata3CabezaEsc00", {autoAlpha:1})
            .set("#escena_00 .rata3OjoEsc00", {autoAlpha:1})
            .set("#escena_00 .rata3CuerpoEsc00", {autoAlpha:1})
            .set("#escena_00 .rata3ColaEsc00", {autoAlpha:1})
            //RATA 4
            .from('#escena_00 .rata4OjoEsc00', 1, {duration:2, ease: Power4.easeOut,repeat:-1},0)
            .set("#escena_00 .rata4CabezaEsc00", {autoAlpha:1})
            .set("#escena_00 .rata4CuerpoEsc00", {autoAlpha:1})
            .set("#escena_00 .rata4OjoEsc00", {autoAlpha:1})
            .set("#escena_00 .rata4ColaEsc00", {autoAlpha:1}) 
        ANIM.main_tl.add(preAnimacion1_2, '0_2-=1');
        /* Escena01 */
        let preAnimacion2 = new TimelineMax();
        preAnimacion2
             //RATA 1
            .from('#escena_01 .rata1OjoEsc01', 1.3, {autoAlpha:1,duration:2, ease: Power4.easeOut,repeat:8},0)
            .addCallback(function(){
            Player.playSoundFX('voz_de_rata_1');
            Player.cambiaVolume('voz_de_rata_1', true);  
          }, 0)
          .addCallback(function(){
            Player.playSoundFX('voz_de_rata_2');
            Player.cambiaVolume('voz_de_rata_2', true);  
          }, 3)
            .set("#escena_01 .rata1ColaEsc01", {transformOrigin:"center top",repeat:-1})
            .to('#escena_01 .rata1ColaEsc01', 1.5, {rotation:13, ease:"wiggle",yoyo:true,repeat:-1}) 
            //RATA 2
            .to('#escena_01 .rata2OjoEsc01', 1.3, {autoAlpha:1, duration:.3,ease: Power4.easeOut ,repeat:4}, 0.3)
        ANIM.main_tl.add(preAnimacion2, '1_0-=0');
        /* Escena02*/
        let preAnimacion3_1 = new TimelineMax();
        preAnimacion3_1
            .fromTo('#escena_02 .ratonNegroEsc02',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:-1},0)
            .fromTo('#escena_02 .ratonCafeEsc02',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:-1},0)
            .fromTo('#escena_02 .ratonesEsc02',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:-1},0)
            .fromTo('#escena_02 .ratonTejadoNegroEsc02',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:-1},0)
            .fromTo('#escena_02 .ratonTejadoCafeEsc02',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:-1},0)
        ANIM.main_tl.add(preAnimacion3_1, '2_0-=0');

        let preAnimacion3_2 = new TimelineMax();
        preAnimacion3_2
            .fromTo('#escena_02 .ratonNegroEsc02',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:-1},0)
            .fromTo('#escena_02 .ratonCafeEsc02',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:-1},0)
            .fromTo('#escena_02 .ratonesEsc02',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:-1},0)
            .fromTo('#escena_02 .ratonTejadoNegroEsc02',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:-1},0)
            .fromTo('#escena_02 .ratonTejadoCafeEsc02',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:-1},0)
        ANIM.main_tl.add(preAnimacion3_2);

        /* Escena 04 */
        var pathString = "M1105.416 483.219c90.371 184.09 201.866 229.89 246.672 65.601 34.111-29.756-221.296-440.778-545.576-351.442-214.214 36.82-127.189 164.007-180.743 428.427-46.859 384.915-328.015 334.709-455.204 6.694-56.9-50.206 73.636-207.519 43.513-331.369 13.388-133.883-163.211-274.744-351.057-118.178-47.656 13.678-168.151 83.966-488.673 331.356";

        pathAlternativoRataNegra = "M-27.8 33.004 566.787 33.004 728.13 460.269"

        var arrayPath = [];
        var newPath = Snap.path.toCubic(pathString);

        function setUpPoint(segment){
          for(var i = 0; i < segment.length; i+=2){
            var point = {};
            point.x = segment[i];
            point.y = segment[i+1];
            arrayPath.push(point);
          }
        }

        
        for(var i = 0; i < newPath.length; i++){
          var segment = newPath[i], pointt;
          segment.shift();
          pointt = setUpPoint(segment);
        }

        const notasMusicales = [
          "#escena_03 .nota1Esc03",
          "#escena_03 .nota2Esc03",
          "#escena_03 .nota3Esc03",
          "#escena_03 .nota4Esc03",
          "#escena_03 .nota5Esc03",
          "#escena_03 .nota6Esc03",
          "#escena_03 .nota7Esc03",
          "#escena_03 .nota8Esc03",
          "#escena_03 .nota9Esc03",
         /*  "#escena_03 .nota10Esc03",
          "#escena_03 .nota11Esc03",
          "#escena_03 .nota12Esc03",
          "#escena_03 .nota13Esc03",
          "#escena_03 .nota14sc03",
          "#escena_03 .nota15Esc03",
          "#escena_03 .nota16Esc03",
          "#escena_03 .nota17Esc03",
          "#escena_03 .nota18Esc03",
          "#escena_03 .nota19Esc03",
          "#escena_03 .nota20Esc03",
          "#escena_03 .nota21Esc03", */
        ]
        let preAnimacion4 = new TimelineMax();
        preAnimacion4
          .addCallback(function(){
            Player.playSoundFX('copia_de_musica_flauta_magica_Esc04');
            ANIM.fadeVolume('copia_de_musica_flauta_magica_Esc04',1,0,32);
          }, "-=15")

          .fromTo('#escena_03 .flautistaEsc03', 2.5,{backgroundPosition:'0% 0%'},{backgroundPosition:'600% 0%', ease: SteppedEase.config(6), repeat:8}, "-=15")

          for(let i=0; i<notasMusicales.length;i++){
            preAnimacion4
              .set(notasMusicales[i], { xPercent: -50, yPercent: -50, autoAlpha:1, immediateRender: false, transformOrigin:"50% 50%"}, 1.5*i)
              .to(notasMusicales[i], 15, {bezier:{type:"cubic", values:arrayPath,  autoRotate: false},ease:Linear.easeNone}, 1.5*i)
              .to(notasMusicales[i], 0.3, {rotation: 40, yoyo:true, transformOrigin: "center", ease: Power0.easeNone,repeat:-1}, 1.5*i)
          } 
          
        ANIM.main_tl.add(preAnimacion4, '3_3-=0')
        /* Escena 04 */
        let preAnimacion5 = new TimelineMax({repeat:-1});
        preAnimacion5
            .to("#escena_04 .nube1",35,{x:1400,yoyo:true},0)
            .to("#escena_04 .nube2",35,{x:-1400,yoyo:true},0)
            .to("#escena_04 .rayosDeSol",4,{opacity:0.5, scale:0.9,repeat:-1},0)
            .from("#escena_04 .rayosDeSol",4,{ scale: 1.05, 
              duration: 1.5,
              stagger: {
                each: 0.5,
                repeat: -1,
              }})
        ANIM.main_tl.add(preAnimacion5, '4_0+=0');

        /* Escena 08 */
        let preAnimacion8 = new TimelineMax({repeat:-1});
        preAnimacion8
            .to("#escena_07 .nube1Esc07",35,{x:1400,yoyo:true},0)
            .to("#escena_07 .nube2Esc07",35,{x:-1400,yoyo:true},0)
            .to("#escena_07 .solRayosEsc07",4,{opacity:0.5, scale:0.9,repeat:-1},0)
            .from("#escena_07 .solRayosEsc07",4,{ scale: 1.05, 
              duration: 1.5,
              stagger: {
                each: 0.5,
                repeat: -1,
              }})

        ANIM.main_tl.add(preAnimacion8, '7_0+=0');
       
        /* Escena 06 */
        let preAnimacion7_0 = new TimelineMax();
        preAnimacion7_0
            .addCallback(function(){
              Player.playSoundFX('hoya_hirviendo');
              Player.cambiaVolume('hoya_hirviendo', true);  
            })
            .fromTo('#escena_06 .cerditoEsc7',0.4,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:-1}) 
            .fromTo('#escena_06 .fuego',0.6,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:-1},0) 
            .to('#escena_06 .humo',3,{y:-600,repeat:-1},0)
            .to('#escena_06 .humo2',3,{y:-600,repeat:-1},1)

        ANIM.main_tl.add(preAnimacion7_0, '6_0+=0');

        let preAnimacion7_1 = new TimelineMax();
        preAnimacion7_1
            .addCallback(function(){
              Player.playSoundFX('hoya_hirviendo');
              Player.cambiaVolume('hoya_hirviendo', true);  
            })
        ANIM.main_tl.add(preAnimacion7_1, '6_1+=0');
        
        let preAnimacion7_2 = new TimelineMax();
        preAnimacion7_2
            .addCallback(function(){
              Player.playSoundFX('hoya_hirviendo');
              Player.cambiaVolume('hoya_hirviendo', true);  
            })
        ANIM.main_tl.add(preAnimacion7_2, '6_2+=0');

        let preAnimacion7_3 = new TimelineMax();
        preAnimacion7_3
            .addCallback(function(){
              Player.playSoundFX('hoya_hirviendo');
              Player.cambiaVolume('hoya_hirviendo', true);  
            })
        ANIM.main_tl.add(preAnimacion7_3, '6_3+=0');

              
        ANIM.main_tl.addLabel('0_0_audio', 'escena_0+=0.1');
        ANIM.main_tl.addLabel('0_0_audio_fade', '0_0-=2');
        ANIM.main_tl.addCallback(function () {
            Player.playSoundFX('copia_de_musica_flauta_magica_Esc01');
            //Player.cambiaVolume('copia_de_musica_flauta_magica_Esc01', 0.3);
        }, '0_0_audio');
        ANIM.main_tl.addCallback(function () {
            ANIM.fadeVolume('copia_de_musica_flauta_magica_Esc01',1,0,2);
        }, "0_0_audio_fade");
        
        ANIM.main_tl.addLabel('3_0_audio', 'escena_3+=0.1');
        ANIM.main_tl.addLabel('3_0_audio_fade', '3_0-=2');
        ANIM.main_tl.addCallback(function () {
            Player.playSoundFX('flauta_solucion');
            Player.cambiaVolume('flauta_solucion', 0.3);
        }, '3_0_audio');
        ANIM.main_tl.addCallback(function () {
            ANIM.fadeVolume('flauta_solucion',1,0,2);
        }, "3_0_audio_fade");

        ANIM.main_tl.addLabel('7_0_audio', 'escena_7+=0.1');
        ANIM.main_tl.addLabel('7_0_audio_fade', '7_1-=3');
        ANIM.main_tl.addCallback(function () {
            Player.playSoundFX('copia_de_musica_flauta_magica_esc_08');
            Player.cambiaVolume('copia_de_musica_flauta_magica_esc_08', 0.3);
        }, '7_0_audio');
        ANIM.main_tl.addCallback(function () {
            ANIM.fadeVolume('copia_de_musica_flauta_magica_esc_08',1,0,2);
        }, "7_0_audio_fade");
 
        /*INICIO*/
        /*LLAMADAS Y FUNCIONES ESCENA 0*/ //<-----------------------------------------------------
        ANIM.main_tl.addCallback(function () {
            Player.hideOthersBut('escena_00');
        }, "escena_0"); 
     
        ANIM.main_tl.addCallback(function () {
            Player.activaBtnSiguiente(); 
            ANIM.main_tl.pause(); 
            ANIM.interactividad(0); 
            Player.tooglePlayPauseIco();
            Player.resetSubtitulos();
            Player.playSoundFX('copia_de_mercado');
            Player.cambiaVolume('copia_de_mercado', 0.5);  
        }, "fin_escena_0"); 

        ANIM.main_tl.addCallback(function () {
            Player.hideOthersBut('escena_01');
        }, "escena_1");

        ANIM.main_tl.addCallback(function () {
            ANIM.main_tl.pause();
            Player.activaBtnSiguiente();
            ANIM.interactividad(1);
            Player.tooglePlayPauseIco();
            Player.resetSubtitulos();
            Player.playSoundFX('publico_disgustado_copia');
            Player.cambiaVolume('publico_disgustado_copia', 0.5);
        }, "fin_escena_1");
        
        /*LLAMADAS Y FUNCIONES ESCENA 2*/ //<-----------------------------------------------------
        ANIM.main_tl.addCallback(function () {
            Player.hideOthersBut('escena_02');
        }, "escena_2");
        
        ANIM.main_tl.addCallback(function () {
            ANIM.main_tl.pause();
            ANIM.interactividad(2);
            Player.activaBtnSiguiente();
            Player.tooglePlayPauseIco();
            Player.resetSubtitulos();
        }, "fin_escena_2");
        
        /*LLAMADAS Y FUNCIONES ESCENA 3*/ //<-----------------------------------------------------
        ANIM.main_tl.addCallback(function (){ 
            Player.hideOthersBut('escena_03');
        }, "escena_3");
      
        ANIM.main_tl.addCallback(function () {
            ANIM.main_tl.pause();
            ANIM.interactividad(3);
            Player.activaBtnSiguiente();
            Player.tooglePlayPauseIco();
            Player.resetSubtitulos();
        }, "fin_escena_3");
        
        /*LLAMADAS Y FUNCIONES ESCENA 4*/ //<-----------------------------------------------------
        ANIM.main_tl.addCallback(function () {
            Player.hideOthersBut('escena_04');
        }, "escena_4");

        ANIM.main_tl.addCallback(function () {
            ANIM.main_tl.pause();
            ANIM.interactividad(4);
            Player.activaBtnSiguiente();
            Player.tooglePlayPauseIco();
            Player.resetSubtitulos();
        }, "fin_escena_4");
        
        /*LLAMADAS Y FUNCIONES ESCENA 5*/ //<-----------------------------------------------------
        ANIM.main_tl.addCallback(function () {
            Player.hideOthersBut('escena_05');
        }, "escena_5");
        
        ANIM.main_tl.addCallback(function () {
            ANIM.main_tl.pause();
            ANIM.interactividad(5);
            Player.activaBtnSiguiente();
            Player.tooglePlayPauseIco();
            Player.resetSubtitulos();
            Player.playSoundFX('copia_de_musica_flauta_magica_Esc06');
            ANIM.fadeVolume('copia_de_musica_flauta_magica_Esc06',1,0,44);
            //Player.cambiaVolume('copia_de_musica_flauta_magica_Esc06', 0.3);
        }, "fin_escena_5");
        
        /*LLAMADAS Y FUNCIONES ESCENA 6*/ //<-----------------------------------------------------
        ANIM.main_tl.addCallback(function () {
            Player.hideOthersBut('escena_06');
        }, "escena_6");

        ANIM.main_tl.addCallback(function () {
            ANIM.main_tl.pause();
            ANIM.interactividad(6);
            Player.activaBtnSiguiente();
            Player.tooglePlayPauseIco();
            Player.resetSubtitulos();
            Player.playSoundFX('copia_de_copia_de_musica_flauta_magica');
            ANIM.fadeVolume('copia_de_copia_de_musica_flauta_magica',1,0,30);
        }, "fin_escena_6");
        
        /*LLAMADAS Y FUNCIONES ESCENA 7*/ //<-----------------------------------------------------
        ANIM.main_tl.addCallback(function () {
            Player.hideOthersBut('escena_07');
        }, "escena_7");
        
        ANIM.main_tl.addCallback(function () {
            ANIM.main_tl.pause();
            ANIM.interactividad(7);
            Player.activaBtnSiguiente();
            Player.tooglePlayPauseIco();
            Player.resetSubtitulos();
            Player.playSoundFX('copia_de_musica_flauta_magica_Esc01');
            Player.cambiaVolume('copia_de_musica_flauta_magica_Esc01', 0.3);
        }, "fin_escena_7");
            
      ANIM.creaAnimInteractividad();
      ANIM.main_tl.pause();
    },
    //timelines de interaccion
    creaAnimInteractividad: () => {
      /********ESCENA 00 *********/
        ANIM.anim_interact_ciudad = new TimelineMax(); // creo la interacción
        ANIM.anim_interact_ciudad
            .addLabel('inicio')
            .addCallback(function(){
              Player.playSoundFX('ciudad_de_ratas_copia');
              Player.cambiaVolume('ciudad_de_ratas_copia', 0.5); 
            },0)
            .fromTo('#escena_00 .sillonEsc00',1.5,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:7})
            .to('#escena_00 .turbanteEsc00',7,{x:1480},1)
            .fromTo('#escena_00 .turbanteEsc00',1.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:7},0)
            .fromTo('#escena_00 .diarioEsc00',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:7},1.5)
            .fromTo('#escena_00 .fruteraEsc00',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:7},2.2)
            .set("#escena_00 .ciudadanoEsc00", {transformOrigin:"center top",repeat:7},2.8)
            .to('#escena_00 .ciudadanoEsc00', 1, {rotation:25,x:-60, ease:"wiggle",yoyo:true,repeat:7},2.8)
            .fromTo('#escena_00 .ciudadanoEsc00',.5,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:14},2.8)
            .fromTo('#escena_00 .mujerEsc00',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:8},3.1)
            .to('#escena_00 .ratonEsc00',5,{x:-1400, ease:Power4.easeOut, repeat:1},7)

            .addLabel('final');
        ANIM.anim_interact_ciudad.pause();
  
        /********ESCENA 01 *********/
        const ciudadanosArray = [
          '#escena_01 .pinochoEsc01',
          '#escena_01 .monjaEsc01',
          '#escena_01 .cerditosEsc01',
          '#escena_01 .resadoraEsc01',
          '#escena_01 .rubiaEsc01',
          '#escena_01 .rubioEsc01',
          '#escena_01 .cabelloNegroEsc01',
          '#escena_01 .azulEsc01',
          '#escena_01 .chicoAzulEsc01',
        ]

        ANIM.anim_interact_ciudadFuriosa = new TimelineMax(); // creo la interacción
        ANIM.anim_interact_ciudadFuriosa
            .addLabel('inicio')
            .from("#escena_01 .rata1OjoEsc01",0.5,{autoAlpha:1, delay:1.0, immediateRender:false},0)
            .from("#escena_01 .rata1OjoEsc01",1.0,{autoAlpha:0, delay:2.0, immediateRender:false},0)
            .from("#escena_01 .rata1OjoEsc01",0.5,{autoAlpha:1, delay:3.0, immediateRender:false},0)
            .from("#escena_01 .rata1OjoEsc01",1.0,{autoAlpha:0, delay:4.0, immediateRender:false},0)
            .from("#escena_01 .rata1OjoEsc01",0.5,{autoAlpha:1, delay:5.0, immediateRender:false},0)
            .from("#escena_01 .rata1OjoEsc01",1.0,{autoAlpha:0, delay:6.0, immediateRender:false},0) 
            .from("#escena_01 .rata1OjoEsc01",0.5,{autoAlpha:1, delay:7.0, immediateRender:false},0)
            .from("#escena_01 .rata1OjoEsc01",1.0,{autoAlpha:0, delay:8.0, immediateRender:false},0) 
            .from("#escena_01 .rata1OjoEsc01",0.5,{autoAlpha:1, delay:9.0, immediateRender:false},0)
            .from("#escena_01 .rata1OjoEsc01",1.0,{autoAlpha:0, delay:10.0, immediateRender:false},0) 
            .from("#escena_01 .rata1OjoEsc01",0.5,{autoAlpha:1, delay:11.0, immediateRender:false},0)
            .from("#escena_01 .rata1OjoEsc01",1.0,{autoAlpha:0, delay:12.0, immediateRender:false},0) 
            .from("#escena_01 .rata1OjoEsc01",0.5,{autoAlpha:1, delay:13.0, immediateRender:false},0)
            .from("#escena_01 .rata1OjoEsc01",1.0,{autoAlpha:0, delay:14.0, immediateRender:false},0) 
            .from("#escena_01 .rata1OjoEsc01",0.5,{autoAlpha:1, delay:15.0, immediateRender:false},0)
            .from("#escena_01 .rata1OjoEsc01",1.0,{autoAlpha:0, delay:16.0, immediateRender:false},0) 
            .from("#escena_01 .rata1OjoEsc01",0.5,{autoAlpha:1, delay:17.0, immediateRender:false},0)
            .from("#escena_01 .rata1OjoEsc01",1.0,{autoAlpha:0, delay:18.0, immediateRender:false},0) 
            .from("#escena_01 .rata1OjoEsc01",0.5,{autoAlpha:1, delay:19.0, immediateRender:false},0)
            .from("#escena_01 .rata1OjoEsc01",1.0,{autoAlpha:0, delay:20.0, immediateRender:false},0) 

            .from("#escena_01 .rata2OjoEsc01",0.5,{autoAlpha:1, delay:1.0, immediateRender:false},0)
            .from("#escena_01 .rata2OjoEsc01",1.0,{autoAlpha:0, delay:2.0, immediateRender:false},0)
            .from("#escena_01 .rata2OjoEsc01",0.5,{autoAlpha:1, delay:3.0, immediateRender:false},0)
            .from("#escena_01 .rata2OjoEsc01",1.0,{autoAlpha:0, delay:4.0, immediateRender:false},0)
            .from("#escena_01 .rata2OjoEsc01",0.5,{autoAlpha:1, delay:5.0, immediateRender:false},0)
            .from("#escena_01 .rata2OjoEsc01",1.0,{autoAlpha:0, delay:6.0, immediateRender:false},0) 
            .from("#escena_01 .rata2OjoEsc01",0.5,{autoAlpha:1, delay:7.0, immediateRender:false},0)
            .from("#escena_01 .rata2OjoEsc01",1.0,{autoAlpha:0, delay:8.0, immediateRender:false},0) 
            .from("#escena_01 .rata2OjoEsc01",0.5,{autoAlpha:1, delay:9.0, immediateRender:false},0)
            .from("#escena_01 .rata2OjoEsc01",1.0,{autoAlpha:0, delay:10.0, immediateRender:false},0) 
            .from("#escena_01 .rata2OjoEsc01",0.5,{autoAlpha:1, delay:11.0, immediateRender:false},0)
            .from("#escena_01 .rata2OjoEsc01",1.0,{autoAlpha:0, delay:12.0, immediateRender:false},0) 
            .from("#escena_01 .rata2OjoEsc01",0.5,{autoAlpha:1, delay:13.0, immediateRender:false},0)
            .from("#escena_01 .rata2OjoEsc01",1.0,{autoAlpha:0, delay:14.0, immediateRender:false},0) 
            .from("#escena_01 .rata2OjoEsc01",0.5,{autoAlpha:1, delay:15.0, immediateRender:false},0)
            .from("#escena_01 .rata2OjoEsc01",1.0,{autoAlpha:0, delay:16.0, immediateRender:false},0) 
            .from("#escena_01 .rata2OjoEsc01",0.5,{autoAlpha:1, delay:17.0, immediateRender:false},0)
            .from("#escena_01 .rata2OjoEsc01",1.0,{autoAlpha:0, delay:18.0, immediateRender:false},0) 
            .from("#escena_01 .rata2OjoEsc01",0.5,{autoAlpha:1, delay:19.0, immediateRender:false},0)
            .from("#escena_01 .rata2OjoEsc01",1.0,{autoAlpha:0, delay:20.0, immediateRender:false},0) 
            
            .fromTo('#escena_01 .enojadaEsc01',1.5,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:5}, 0)
            .fromTo('#escena_01 .rojoEsc01',1.5,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:5},0)

            .to('#escena_01 .bocado1Esc01',.1,{autoAlpha:1},1)
            .to('#escena_01 .bocado1Esc01',1.4,{y:-60, ease: Elastic.easeOut.config(2.5,0.3)},1)
            .to('#escena_01 .bocado1Esc01',.1,{autoAlpha:0},3.5)

            .to('#escena_01 .bocado2Esc01',.1,{autoAlpha:1},3.7)
            .to('#escena_01 .bocado2Esc01',1.4,{y:-60, ease: Elastic.easeOut.config(2.5,0.3)},3.7)
            .to('#escena_01 .bocado2Esc01',.1,{autoAlpha:0},6.2)

            .to('#escena_01 .bocado3Esc01',.1,{autoAlpha:1},6.4)
            .to('#escena_01 .bocado3Esc01',1.4,{y:-60, ease: Elastic.easeOut.config(2.5,0.3)},6.4)
            .to('#escena_01 .bocado3Esc01',.1,{autoAlpha:0},8.9)

            .fromTo('#escena_01 .pintorEsc01',1.5,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:5},4)

            .to('#escena_01 .bocado4Esc01',.1,{autoAlpha:1},5)
            .to('#escena_01 .bocado4Esc01',1.4,{y:-60, ease: Elastic.easeOut.config(2.5,0.3)},5)
            .to('#escena_01 .bocado4Esc01',.1,{autoAlpha:0},7.5)

            .to('#escena_01 .bocado5Esc01',.1,{autoAlpha:1},7.7)
            .to('#escena_01 .bocado5Esc01',1.4,{y:-60, ease: Elastic.easeOut.config(2.5,0.3)},7.7)
            .to('#escena_01 .bocado5Esc01',.1,{autoAlpha:0},10.2)

            .to('#escena_01 .bocado6Esc01',.1,{autoAlpha:1},10.4)
            .to('#escena_01 .bocado6Esc01',1.4,{y:-60, ease: Elastic.easeOut.config(2.5,0.3)},10.4)
            .to('#escena_01 .bocado6Esc01',.1,{autoAlpha:0},12.9)

            .fromTo('#escena_01 .alcaldeEsc01',1.5,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:7},7)

            .fromTo(ciudadanosArray,1.5,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:7},7.5)
            .addLabel('final');
        ANIM.anim_interact_ciudadFuriosa.pause(); 
    
        /********ESCENA 02 *********/
        const ratones = [
          '#escena_02 .ratonNegroEsc02',
          '#escena_02 .ratonCafeEsc02',
          '#escena_02 .ratonesEsc02',
          '#escena_02 .ratonTejadoNegroEsc02',
          '#escena_02 .ratonTejadoCafeEsc02'
        ];

        const ojos = [
          '#escena_02 .flautistaOjosCerradosDerEsc02',
          '#escena_02 .flautistaOjosCerradosIzqEsc02'
        ]

        const publico = [
          '#escena_02 .alcaldeEsc02',
          '#escena_02 .ninoEsc02',
          '#escena_02 .monjaEsc02',
          '#escena_02 .mujerVerdeEsc02',
          '#escena_02 .mujerCafeEsc02',
          '#escena_02 .mujerRojoEsc02'
        ]

        ANIM.anim_interact_flautista = new TimelineMax(); // creo la interacción
        ANIM.anim_interact_flautista
            .addLabel('inicio')
            .addCallback(function(){
              Player.playSoundFX('flauta_solucion');
              Player.cambiaVolume('flauta_solucion', 0.5); 
            },0)
            .fromTo(ratones,1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:12},0)
            .fromTo("#escena_02 .flautistaBrazoDerEsc02",0.8, {rotation:0},{rotation:5, y:-30,yoyo:true, ease: Power0.easeOut, repeat:8}, 0)
            .fromTo("#escena_02 .flautistaBrazoIzqEsc02",0.8,{rotation:0},{rotation:6, y:9, x:0,yoyo:true, ease: Power0.easeOut, repeat:8},0)
            .to('#escena_02 .plumaFlautista', 1,{rotation:8, y:-32,yoyo:true, ease: Power3.easeOut, repeat:5},0)
           
            .from(ojos,0.4,{autoAlpha:1, delay:1.0, immediateRender:false},0)
            .from(ojos,1.5,{autoAlpha:0, delay:2.0, immediateRender:false},0)
            .from(ojos,0.4,{autoAlpha:1, delay:3.0, immediateRender:false},0)
            .from(ojos,1.5,{autoAlpha:0, delay:4.0, immediateRender:false},0)
            .from(ojos,0.4,{autoAlpha:1, delay:5.0, immediateRender:false},0)
            .from(ojos,1.5,{autoAlpha:0, delay:6.0, immediateRender:false},0)
           
            .from("#escena_02 .flautistaBocaEsc02",0.4,{autoAlpha:1, delay:0.5, immediateRender:false},0)
            .from("#escena_02 .flautistaBocaEsc02",1.5,{autoAlpha:0, delay:1.0, immediateRender:false},0)
            .from("#escena_02 .flautistaBocaEsc02",0.4,{autoAlpha:1, delay:1.5, immediateRender:false},0)
            .from("#escena_02 .flautistaBocaEsc02",1.5,{autoAlpha:0, delay:2.0, immediateRender:false},0)
            .from("#escena_02 .flautistaBocaEsc02",0.4,{autoAlpha:1, delay:2.5, immediateRender:false},0)
            .from("#escena_02 .flautistaBocaEsc02",1.5,{autoAlpha:0, delay:3.0, immediateRender:false},0)
            .from("#escena_02 .flautistaBocaEsc02",0.4,{autoAlpha:1, delay:3.5, immediateRender:false},0)
            .from("#escena_02 .flautistaBocaEsc02",1.5,{autoAlpha:0, delay:4.0, immediateRender:false},0)
            .from("#escena_02 .flautistaBocaEsc02",0.4,{autoAlpha:1, delay:4.5, immediateRender:false},0)
            .from("#escena_02 .flautistaBocaEsc02",1.5,{autoAlpha:0, delay:5.0, immediateRender:false},0)
            .from("#escena_02 .flautistaBocaEsc02",0.4,{autoAlpha:1, delay:5.5, immediateRender:false},0)
            .from("#escena_02 .flautistaBocaEsc02",1.5,{autoAlpha:0, delay:6.0, immediateRender:false},0)

            .to("#escena_02 .bocadoEsc02",0.5,{opacity:1},1)
            .to("#escena_02 .bocadoOroEsc02",0.5,{opacity:1},2)
            .to("#escena_02 .bocadoOroEsc02",0.5,{opacity:0},4)
            .to("#escena_02 .bocadoOroEsc02",0.5,{opacity:1},4)
            .to("#escena_02 .bocadoOroEsc02",0.5,{opacity:0},6)
            .to("#escena_02 .bocadoEsc02",0.5,{opacity:0},6)
            .addCallback(function(){
              Player.playSoundFX('publico_asombrado');
              Player.cambiaVolume('publico_asombrado', 0.6); 
            },7)
            .fromTo(publico,1,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:4},7)
            .addLabel('final')
        ANIM.anim_interact_flautista.pause();

        ANIM.anim_interact_flautistaTocandoRatas = new TimelineMax(); // creo la interacción
        ANIM.anim_interact_flautistaTocandoRatas
          .addLabel('inicio')
          .addCallback(function(){
            Player.playSoundFX('rio'); 
            ANIM.fadeVolume('rio',1,0,17);  
          }, "-=30")
    
          //Cafe01
          .set("#escena_03 .rataCafe01Esc03",{opacity:1, immediateRender:false}, 0)
          .fromTo("#escena_03 .rataCafe01Esc03",0.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2), repeat: 12}, 0)
          .to("#escena_03 .rataCafe01Esc03",2.5,{ bezier:{curviness:0.3, values:[{x:1000,y:450}], autoRotate:false}, ease:Linear.easeNone}, 0)
          .set("#escena_03 .rataCafe01Esc03",{opacity:0, immediateRender:false}, 2.5)
          .set("#escena_03 .rataCafeFlotador01Esc03", {opacity:1, immediateRender:false}, 2.5)
          .to("#escena_03 .rataCafeFlotador01Esc03", 1.2, {bezier:{type:"thru", values:[{x:0,y:0}, {x:170,y:-135}, {x:340,y:50}], autoRotate:false },ease:Linear.easeNone}, 2.5)
          .fromTo("#escena_03 .rataCafeFlotador01Esc03",1.5,{backgroundPosition:'-200% 0%'},{backgroundPosition:'-100% 0%', ease: SteppedEase.config(1)},2.5)
          .set("#escena_03 .rataCafeFlotador01Esc03", {opacity:0, immediateRender:false}, 3.7)
          .set("#escena_03 .rataCafeSplash01Esc03", {opacity:1, immediateRender:false}, 3.7)
          .addCallback(function(){
            Player.playSoundFX('chapuzon_de_ratas');
            Player.cambiaVolume('chapuzon_de_ratas', 0.5);    
          },3.7)
          .to("#escena_03 .rataCafeSplash01Esc03", 0.5, {scale: 1.8, opacity: 0.4}, 3.9)
          .set("#escena_03 .rataCafeSplash01Esc03", {opacity:0, immediateRender:false}, 4.4)
          .set("#escena_03 .rataCafeMuerte01Esc03", {opacity:1, immediateRender:false}, 4.4)
          .to("#escena_03 .rataCafeMuerte01Esc03", 5,{ bezier:{curviness:0.3, values:[{x:450,y:-292}], autoRotate:false}, ease:Linear.easeNone}, 4.4)
          
          //Cafe02
          .set("#escena_03 .rataCafe02Esc03",{opacity:1, immediateRender:false}, 0.7)
          .fromTo("#escena_03 .rataCafe02Esc03",0.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2), repeat: 12}, 0.7)
          .to("#escena_03 .rataCafe02Esc03",2.5,{ bezier:{curviness:0.3, values:[{x:881,y:397}], autoRotate:false}, ease:Linear.easeNone}, 0.7)
          .set("#escena_03 .rataCafe02Esc03",{opacity:0, immediateRender:false}, 3.2)
          .set("#escena_03 .rataCafeFlotador02Esc03", {opacity:1, immediateRender:false}, 3.2)
          .to("#escena_03 .rataCafeFlotador02Esc03", 1.2, {bezier:{type:"thru", values:[{x:0,y:0}, {x:160,y:-135}, {x:320,y:50}], autoRotate:false },ease:Linear.easeNone}, 3.2)
          .fromTo("#escena_03 .rataCafeFlotador02Esc03",1.5,{backgroundPosition:'-200% 0%'},{backgroundPosition:'-100% 0%', ease: SteppedEase.config(1)},3.2)
          .set("#escena_03 .rataCafeFlotador02Esc03", {opacity:0, immediateRender:false}, 4.4)
          .set("#escena_03 .rataCafeSplash02Esc03", {opacity:1, immediateRender:false}, 4.4)
          .addCallback(function(){
            Player.playSoundFX('chapuzon_de_ratas');
            Player.cambiaVolume('chapuzon_de_ratas', 0.5);    
          },4.4)
          .to("#escena_03 .rataCafeSplash02Esc03", 0.5, {scale: 1.8, opacity: 0.4}, 4.6)
          .set("#escena_03 .rataCafeSplash02Esc03", {opacity:0, immediateRender:false}, 5.1)
          .set("#escena_03 .rataCafeMuerte02Esc03", {opacity:1, immediateRender:false}, 5.1)
          .to("#escena_03 .rataCafeMuerte02Esc03", 5,{ bezier:{curviness:0.3, values:[{x:450,y:-292}], autoRotate:false}, ease:Linear.easeNone}, 5.1)

          //Cafe03
          .set("#escena_03 .rataCafe03Esc03",{opacity:1, immediateRender:false}, 2.7)
          .fromTo("#escena_03 .rataCafe03Esc03",0.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2), repeat: 12}, 2.7)
          .to("#escena_03 .rataCafe03Esc03",2.5,{ bezier:{curviness:0.3, values:[{x:1000,y:401}], autoRotate:false}, ease:Linear.easeNone}, 2.7)
          .set("#escena_03 .rataCafe03Esc03",{opacity:0, immediateRender:false}, 5.2)
          .set("#escena_03 .rataCafeFlotador03Esc03", {opacity:1, immediateRender:false}, 5.2)
          .to("#escena_03 .rataCafeFlotador03Esc03", 1.2, {bezier:{type:"thru", values:[{x:0,y:0}, {x:200,y:-135}, {x:400,y:60}], autoRotate:false },ease:Linear.easeNone}, 5.2)
          .fromTo("#escena_03 .rataCafeFlotador03Esc03",1.5,{backgroundPosition:'-200% 0%'},{backgroundPosition:'-100% 0%', ease: SteppedEase.config(1)},5.2)
          .set("#escena_03 .rataCafeFlotador03Esc03", {opacity:0, immediateRender:false}, 6.4)
          .set("#escena_03 .rataCafeSplash03Esc03", {opacity:1, immediateRender:false}, 6.4)
          .addCallback(function(){
            Player.playSoundFX('chapuzon_de_ratas');
            Player.cambiaVolume('chapuzon_de_ratas', 0.5);    
          },6.4)
          .to("#escena_03 .rataCafeSplash03Esc03", 0.5, {scale: 1.8, opacity: 0.4}, 6.6)
          .set("#escena_03 .rataCafeSplash03Esc03", {opacity:0, immediateRender:false}, 7.1)
          .set("#escena_03 .rataCafeMuerte03Esc03", {opacity:1, immediateRender:false}, 7.1)
          .to("#escena_03 .rataCafeMuerte03Esc03", 5,{ bezier:{curviness:0.3, values:[{x:450,y:-292}], autoRotate:false}, ease:Linear.easeNone}, 7.1)

          //Cafe04
          .set("#escena_03 .rataCafe04Esc03",{opacity:1, immediateRender:false}, 2.9)
          .fromTo("#escena_03 .rataCafe04Esc03",0.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2), repeat: 12}, 2.9)
          .to("#escena_03 .rataCafe04Esc03",2.5,{ bezier:{curviness:0.3, values:[{x:604,y:404}], autoRotate:false}, ease:Linear.easeNone}, 2.9)
          .set("#escena_03 .rataCafe04Esc03",{opacity:0, immediateRender:false}, 5.4)
          .set("#escena_03 .rataCafeFlotador04Esc03", {opacity:1, immediateRender:false}, 5.4)
          .to("#escena_03 .rataCafeFlotador04Esc03", 1.2, {bezier:{type:"thru", values:[{x:0,y:0}, {x:150,y:-135}, {x:300,y:90}], autoRotate:false },ease:Linear.easeNone}, 5.4)
          .fromTo("#escena_03 .rataCafeFlotador04Esc03",1.5,{backgroundPosition:'-200% 0%'},{backgroundPosition:'-100% 0%', ease: SteppedEase.config(1)},5.4)
          .set("#escena_03 .rataCafeFlotador04Esc03", {opacity:0, immediateRender:false}, 6.6)
          .set("#escena_03 .rataCafeSplash04Esc03", {opacity:1, immediateRender:false}, 6.6)
          .addCallback(function(){
            Player.playSoundFX('chapuzon_de_ratas');
            Player.cambiaVolume('chapuzon_de_ratas', 0.5);    
          },6.6)
          .to("#escena_03 .rataCafeSplash04Esc03", 0.5, {scale: 1.8, opacity: 0.4}, 6.8)
          .set("#escena_03 .rataCafeSplash04Esc03", {opacity:0, immediateRender:false}, 7.3)
          .set("#escena_03 .rataCafeMuerte04Esc03", {opacity:1, immediateRender:false}, 7.3)
          .to("#escena_03 .rataCafeMuerte04Esc03", 6.5,{ bezier:{curviness:0.3, values:[{x:450,y:-292}], autoRotate:false}, ease:Linear.easeNone}, 7.3)

          //Cafe05
          .set("#escena_03 .rataCafe05Esc03",{opacity:1, immediateRender:false}, 3.2)
          .fromTo("#escena_03 .rataCafe05Esc03",0.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2), repeat: 12}, 3.2)
          .to("#escena_03 .rataCafe05Esc03",2.5,{ bezier:{curviness:0.3, values:[{x:401,y:415}], autoRotate:false}, ease:Linear.easeNone}, 3.2)
          .set("#escena_03 .rataCafe05Esc03",{opacity:0, immediateRender:false}, 5.7)
          .set("#escena_03 .rataCafeFlotador05Esc03", {opacity:1, immediateRender:false}, 5.7)
          .to("#escena_03 .rataCafeFlotador05Esc03", 1.2, {bezier:{type:"thru", values:[{x:0,y:0}, {x:120,y:-135}, {x:240,y:90}], autoRotate:false },ease:Linear.easeNone}, 5.7)
          .fromTo("#escena_03 .rataCafeFlotador05Esc03",1.5,{backgroundPosition:'-200% 0%'},{backgroundPosition:'-100% 0%', ease: SteppedEase.config(1)},5.7)
          .set("#escena_03 .rataCafeFlotador05Esc03", {opacity:0, immediateRender:false}, 6.9)
          .set("#escena_03 .rataCafeSplash05Esc03", {opacity:1, immediateRender:false}, 6.9)
          .addCallback(function(){
            Player.playSoundFX('chapuzon_de_ratas');
            Player.cambiaVolume('chapuzon_de_ratas', 0.5);    
          },6.9)
          .to("#escena_03 .rataCafeSplash05Esc03", 0.5, {scale: 1.8, opacity: 0.4}, 7.1)
          .set("#escena_03 .rataCafeSplash05Esc03", {opacity:0, immediateRender:false}, 7.6)
          .set("#escena_03 .rataCafeMuerte05Esc03", {opacity:1, immediateRender:false}, 7.6)
          .to("#escena_03 .rataCafeMuerte05Esc03", 6.5,{ bezier:{curviness:0.3, values:[{x:450,y:-292}], autoRotate:false}, ease:Linear.easeNone}, 7.6)
         
          //Cafe06
          .set("#escena_03 .rataCafe06Esc03",{opacity:1, immediateRender:false}, 3.6)
          .fromTo("#escena_03 .rataCafe06Esc03",0.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2), repeat: 12}, 3.6)
          .to("#escena_03 .rataCafe06Esc03",2.5,{ bezier:{curviness:0.3, values:[{x:1060,y:397}], autoRotate:false}, ease:Linear.easeNone}, 3.6)
          .set("#escena_03 .rataCafe06Esc03",{opacity:0, immediateRender:false}, 6.1)
          .set("#escena_03 .rataCafeFlotador06Esc03", {opacity:1, immediateRender:false}, 6.1)
          .to("#escena_03 .rataCafeFlotador06Esc03", 1.2, {bezier:{type:"thru", values:[{x:0,y:0}, {x:220,y:-135}, {x:440,y:30}], autoRotate:false },ease:Linear.easeNone}, 6.1)
          .fromTo("#escena_03 .rataCafeFlotador06Esc03",1.5,{backgroundPosition:'-200% 0%'},{backgroundPosition:'-100% 0%', ease: SteppedEase.config(1)},6.1)
          .set("#escena_03 .rataCafeFlotador06Esc03", {opacity:0, immediateRender:false}, 7.3)
          .set("#escena_03 .rataCafeSplash06Esc03", {opacity:1, immediateRender:false}, 7.3)
          .addCallback(function(){
            Player.playSoundFX('chapuzon_de_ratas');
            Player.cambiaVolume('chapuzon_de_ratas', 0.5);    
          },7.3)
          .to("#escena_03 .rataCafeSplash06Esc03", 0.5, {scale: 1.8, opacity: 0.4}, 7.5)
          .set("#escena_03 .rataCafeSplash06Esc03", {opacity:0, immediateRender:false}, 8.0)
          .set("#escena_03 .rataCafeMuerte06Esc03", {opacity:1, immediateRender:false}, 8.0)
          .to("#escena_03 .rataCafeMuerte06Esc03", 6.5,{ bezier:{curviness:0.3, values:[{x:570,y:-330}], autoRotate:false}, ease:Linear.easeNone}, 8.0)
          
          //Cafe07
          .set("#escena_03 .rataCafe07Esc03",{opacity:1, immediateRender:false}, 3.9)
          .fromTo("#escena_03 .rataCafe07Esc03",0.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2), repeat: 12}, 3.9)
          .to("#escena_03 .rataCafe07Esc03",2.5,{ bezier:{curviness:0.3, values:[{x:1058,y:297}], autoRotate:false}, ease:Linear.easeNone}, 3.9)
          .set("#escena_03 .rataCafe07Esc03",{opacity:0, immediateRender:false}, 6.4)
          .set("#escena_03 .rataCafeFlotador07Esc03", {opacity:1, immediateRender:false}, 6.4)
          .to("#escena_03 .rataCafeFlotador07Esc03", 1.2, {bezier:{type:"thru", values:[{x:0,y:0}, {x:310,y:-135}, {x:620,y:-10}], autoRotate:false },ease:Linear.easeNone}, 6.4)
          .fromTo("#escena_03 .rataCafeFlotador07Esc03",1.5,{backgroundPosition:'-200% 0%'},{backgroundPosition:'-100% 0%', ease: SteppedEase.config(1)},6.4)
          .set("#escena_03 .rataCafeFlotador07Esc03", {opacity:0, immediateRender:false}, 7.6)
          .set("#escena_03 .rataCafeSplash07Esc03", {opacity:1, immediateRender:false}, 7.6)
          .addCallback(function(){
            Player.playSoundFX('chapuzon_de_ratas');
            Player.cambiaVolume('chapuzon_de_ratas', 0.5);    
          },7.6)
          .to("#escena_03 .rataCafeSplash07Esc03", 0.5, {scale: 1.8, opacity: 0.4}, 7.8)
          .set("#escena_03 .rataCafeSplash07Esc03", {opacity:0, immediateRender:false}, 8.3)
          .set("#escena_03 .rataCafeMuerte07Esc03", {opacity:1, immediateRender:false}, 8.3)
          .to("#escena_03 .rataCafeMuerte07Esc03", 6.5,{ bezier:{curviness:0.3, values:[{x:450,y:-292}], autoRotate:false}, ease:Linear.easeNone}, 8.3)

          //Ratas Negras
          //Negra01
          .set("#escena_03 .rataNegra01Esc03",{opacity:1, immediateRender:false}, 0)
          .fromTo("#escena_03 .rataNegra01Esc03",0.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2), repeat: 12}, 0)
          .to("#escena_03 .rataNegra01Esc03",2.5,{ bezier:{curviness:0.3, values:[{x:964,y:432}], autoRotate:false}, ease:Linear.easeNone}, 0)
          .set("#escena_03 .rataNegra01Esc03",{opacity:0, immediateRender:false}, 2.5)
          .set("#escena_03 .rataNegraSnorkel01Esc03", {opacity:1, immediateRender:false}, 2.7)
          .to("#escena_03 .rataNegraSnorkel01Esc03", 1.2, {bezier:{type:"thru", values:[{x:0,y:0}, {x:200,y:-135}, {x:400,y:90}], autoRotate:false },ease:Linear.easeNone}, 2.7)
          .fromTo("#escena_03 .rataNegraSnorkel01Esc03",1.5,{backgroundPosition:'-200% 0%'},{backgroundPosition:'-100% 0%', ease: SteppedEase.config(1)},2.7)
          .set("#escena_03 .rataNegraSnorkel01Esc03", {opacity:0, immediateRender:false}, 3.9)
          .set("#escena_03 .rataNegraSplash01Esc03", {opacity:1, immediateRender:false}, 3.9)
          .addCallback(function(){
            Player.playSoundFX('chapuzon_de_ratas');
            Player.cambiaVolume('chapuzon_de_ratas', 0.5);    
          },3.9)
          .to("#escena_03 .rataNegraSplash01Esc03", 0.5, {scale: 1.8, opacity: 0.4}, 4.1)
          .set("#escena_03 .rataNegraSplash01Esc03", {opacity:0, immediateRender:false}, 4.6)
          .set("#escena_03 .rataNegraMuerte01Esc03", {opacity:1, immediateRender:false}, 4.6)
          .to("#escena_03 .rataNegraMuerte01Esc03", 5,{ bezier:{curviness:0.3, values:[{x:450,y:-292}], autoRotate:false}, ease:Linear.easeNone}, 4.6)
          
          //Negra02
          .set("#escena_03 .rataNegra02Esc03",{opacity:1, immediateRender:false}, 1.4)
          .fromTo("#escena_03 .rataNegra02Esc03",0.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2), repeat: 12}, 1.4)
          .to("#escena_03 .rataNegra02Esc03",2.5,{ bezier:{curviness:0.3, values:[{x:735,y:397}], autoRotate:false}, ease:Linear.easeNone}, 1.4)
          .set("#escena_03 .rataNegra02Esc03",{opacity:0, immediateRender:false}, 3.9)
          .set("#escena_03 .rataNegraSnorkel02Esc03", {opacity:1, immediateRender:false}, 3.9)
          .to("#escena_03 .rataNegraSnorkel02Esc03", 1.2, {bezier:{type:"thru", values:[{x:0,y:0}, {x:130,y:-135}, {x:260,y:90}], autoRotate:false },ease:Linear.easeNone}, 3.9)
          .fromTo("#escena_03 .rataNegraSnorkel02Esc03",1.5,{backgroundPosition:'-200% 0%'},{backgroundPosition:'-100% 0%', ease: SteppedEase.config(1)},3.9)
          .set("#escena_03 .rataNegraSnorkel02Esc03", {opacity:0, immediateRender:false}, 5.1)
          .set("#escena_03 .rataNegraSplash02Esc03", {opacity:1, immediateRender:false}, 5.1)
          .addCallback(function(){
            Player.playSoundFX('chapuzon_de_ratas');
            Player.cambiaVolume('chapuzon_de_ratas', 0.5);    
          },5.1)
          .to("#escena_03 .rataNegraSplash02Esc03", 0.5, {scale: 1.8, opacity: 0.4}, 5.3)
          .set("#escena_03 .rataNegraSplash02Esc03", {opacity:0, immediateRender:false}, 5.8)
          .set("#escena_03 .rataNegraMuerte02Esc03", {opacity:1, immediateRender:false}, 5.8)
          .to("#escena_03 .rataNegraMuerte02Esc03", 5,{ bezier:{curviness:0.3, values:[{x:450,y:-292}], autoRotate:false}, ease:Linear.easeNone}, 5.8)
          
          //Negra03
          .set("#escena_03 .rataNegra03Esc03",{opacity:1, immediateRender:false}, 1.7)
          .fromTo("#escena_03 .rataNegra03Esc03",0.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2), repeat: 12}, 1.7)
          .to("#escena_03 .rataNegra03Esc03",2.5,{ bezier:{curviness:0.3, values:[{x:848,y:464}], autoRotate:false}, ease:Linear.easeNone}, 1.7)
          .set("#escena_03 .rataNegra03Esc03",{opacity:0, immediateRender:false}, 4.2)
          .set("#escena_03 .rataNegraSnorkel03Esc03", {opacity:1, immediateRender:false}, 4.2)
          .to("#escena_03 .rataNegraSnorkel03Esc03", 1.2, {bezier:{type:"thru", values:[{x:0,y:0}, {x:110,y:-135}, {x:220,y:70}], autoRotate:false },ease:Linear.easeNone}, 4.2)
          .fromTo("#escena_03 .rataNegraSnorkel03Esc03",1.5,{backgroundPosition:'-200% 0%'},{backgroundPosition:'-100% 0%', ease: SteppedEase.config(1)},4.2)
          .set("#escena_03 .rataNegraSnorkel03Esc03", {opacity:0, immediateRender:false}, 5.4)
          .set("#escena_03 .rataNegraSplash03Esc03", {opacity:1, immediateRender:false}, 5.4)
          .addCallback(function(){
            Player.playSoundFX('chapuzon_de_ratas');
            Player.cambiaVolume('chapuzon_de_ratas', 0.5);    
          },5.4)
          .to("#escena_03 .rataNegraSplash03Esc03", 0.5, {scale: 1.8, opacity: 0.4}, 5.6)
          .set("#escena_03 .rataNegraSplash03Esc03", {opacity:0, immediateRender:false}, 6.1)
          .set("#escena_03 .rataNegraMuerte03Esc03", {opacity:1, immediateRender:false}, 6.1)
          .to("#escena_03 .rataNegraMuerte03Esc03", 5,{ bezier:{curviness:0.3, values:[{x:560,y:-380}], autoRotate:false}, ease:Linear.easeNone}, 6.1)
          
           //Negra04 
          .set("#escena_03 .rataNegra04Esc03",{opacity:1, immediateRender:false}, 2.0)
          .fromTo("#escena_03 .rataNegra04Esc03",0.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2), repeat: 12}, 2.0)
          .to("#escena_03 .rataNegra04Esc03",2.5,{ bezier:{curviness:0.3, values:[{x:1114,y:173}], autoRotate:false}, ease:Linear.easeNone}, 2.0)
          .set("#escena_03 .rataNegra04Esc03",{opacity:0, immediateRender:false}, 4.5)
          .set("#escena_03 .rataNegraSnorkel04Esc03", {opacity:1, immediateRender:false}, 4.5)
          .to("#escena_03 .rataNegraSnorkel04Esc03", 1.2, {bezier:{type:"thru", values:[{x:0,y:0}, {x:250,y:-135}, {x:500,y:35}], autoRotate:false },ease:Linear.easeNone}, 4.5)
          .fromTo("#escena_03 .rataNegraSnorkel04Esc03",1.5,{backgroundPosition:'-200% 0%'},{backgroundPosition:'-100% 0%', ease: SteppedEase.config(1)},4.5)
          .set("#escena_03 .rataNegraSnorkel04Esc03", {opacity:0, immediateRender:false}, 5.7)
          .set("#escena_03 .rataNegraSplash04Esc03", {opacity:1, immediateRender:false}, 5.7)
          .addCallback(function(){
            Player.playSoundFX('chapuzon_de_ratas');
            Player.cambiaVolume('chapuzon_de_ratas', 0.5);    
          },5.7)
          .to("#escena_03 .rataNegraSplash04Esc03", 0.5, {scale: 1.8, opacity: 0.4}, 5.9)
          .set("#escena_03 .rataNegraSplash04Esc03", {opacity:0, immediateRender:false}, 6.4)
          .set("#escena_03 .rataNegraMuerte04Esc03", {opacity:1, immediateRender:false}, 6.4)
          .to("#escena_03 .rataNegraMuerte04Esc03", 6,{ bezier:{curviness:0.3, values:[{x:560,y:-380}], autoRotate:false}, ease:Linear.easeNone}, 6.4)

          //Negra05
          .set("#escena_03 .rataNegra05Esc03",{opacity:1, immediateRender:false}, 3.9)
          .fromTo("#escena_03 .rataNegra05Esc03",0.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2), repeat: 12}, 3.9)
          .to("#escena_03 .rataNegra05Esc03",2.5,{ bezier:{curviness:0.3, values:[{x:1102,y:50}], autoRotate:false}, ease:Linear.easeNone}, 3.9)
          .set("#escena_03 .rataNegra05Esc03",{opacity:0, immediateRender:false}, 6.4)
          .set("#escena_03 .rataNegraSnorkel05Esc03", {opacity:1, immediateRender:false}, 6.4)
          .to("#escena_03 .rataNegraSnorkel05Esc03", 1.2, {bezier:{type:"thru", values:[{x:0,y:0}, {x:60,y:-135}, {x:120,y:140}], autoRotate:false },ease:Linear.easeNone}, 6.4)
          .fromTo("#escena_03 .rataNegraSnorkel05Esc03",1.5,{backgroundPosition:'-200% 0%'},{backgroundPosition:'-100% 0%', ease: SteppedEase.config(1)}, 6.4)
          .set("#escena_03 .rataNegraSnorkel05Esc03", {opacity:0, immediateRender:false}, 7.6)
          .set("#escena_03 .rataNegraSplash05Esc03", {opacity:1, immediateRender:false}, 7.6)
          .addCallback(function(){
            Player.playSoundFX('chapuzon_de_ratas');
            Player.cambiaVolume('chapuzon_de_ratas', 0.5);    
          },7.6)
          .to("#escena_03 .rataNegraSplash05Esc03", 0.5, {scale: 1.8, opacity: 0.4}, 7.8)
          .set("#escena_03 .rataNegraSplash05Esc03", {opacity:0, immediateRender:false}, 8.3)
          .set("#escena_03 .rataNegraMuerte05Esc03", {opacity:1, immediateRender:false}, 8.3)
          .to("#escena_03 .rataNegraMuerte05Esc03", 6.6,{ bezier:{curviness:0.3, values:[{x:560,y:-380}], autoRotate:false}, ease:Linear.easeNone}, 8.9)

          //Negra06
          .set("#escena_03 .rataNegra06Esc03",{opacity:1, immediateRender:false}, 3.9)
          .fromTo("#escena_03 .rataNegra06Esc03",0.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2), repeat: 12}, 3.9)
          .to("#escena_03 .rataNegra06Esc03",2.5,{ bezier:{curviness:0.3, values:[{x:468,y:424}], autoRotate:false}, ease:Linear.easeNone}, 3.9)
          .set("#escena_03 .rataNegra06Esc03",{opacity:0, immediateRender:false}, 6.4)
          .set("#escena_03 .rataNegraSnorkel06Esc03", {opacity:1, immediateRender:false}, 6.4)
          .to("#escena_03 .rataNegraSnorkel06Esc03", 1.2, {bezier:{type:"thru", values:[{x:0,y:0}, {x:160,y:-135}, {x:320,y:90}], autoRotate:false },ease:Linear.easeNone}, 6.4)
          .fromTo("#escena_03 .rataNegraSnorkel06Esc03",1.5,{backgroundPosition:'-200% 0%'},{backgroundPosition:'-100% 0%', ease: SteppedEase.config(1)}, 6.4)
          .set("#escena_03 .rataNegraSnorkel06Esc03", {opacity:0, immediateRender:false}, 7.6)
          .set("#escena_03 .rataNegraSplash06Esc03", {opacity:1, immediateRender:false}, 7.6)
          .addCallback(function(){
            Player.playSoundFX('chapuzon_de_ratas');
            Player.cambiaVolume('chapuzon_de_ratas', 0.5);    
          },7.6)
          .to("#escena_03 .rataNegraSplash06Esc03", 0.5, {scale: 1.8, opacity: 0.4}, 7.8)
          .set("#escena_03 .rataNegraSplash06Esc03", {opacity:0, immediateRender:false}, 8.3)
          .set("#escena_03 .rataNegraMuerte06Esc03", {opacity:1, immediateRender:false}, 8.3)
          .to("#escena_03 .rataNegraMuerte06Esc03", 6,{ bezier:{curviness:0.3, values:[{x:560,y:-380}], autoRotate:false}, ease:Linear.easeNone}, 8.3)

          //Negra07
          .set("#escena_03 .rataNegra07Esc03",{opacity:1, immediateRender:false}, 3.2)
          .fromTo("#escena_03 .rataNegra07Esc03",0.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'-200% 0%', ease: SteppedEase.config(2), repeat: 12}, 3.2)
          .to("#escena_03 .rataNegra07Esc03",2.5,{ bezier:{curviness:0.3, values:[{x:960,y:491}], autoRotate:false}, ease:Linear.easeNone}, 3.2)
          .set("#escena_03 .rataNegra07Esc03",{opacity:0, immediateRender:false}, 5.7)
          .set("#escena_03 .rataNegraSnorkel07Esc03", {opacity:1, immediateRender:false}, 5.7)
          .to("#escena_03 .rataNegraSnorkel07Esc03", 1.2, {bezier:{type:"thru", values:[{x:0,y:0}, {x:300,y:-135}, {x:600,y:10}], autoRotate:false },ease:Linear.easeNone}, 5.7)
          .fromTo("#escena_03 .rataNegraSnorkel07Esc03",1.5,{backgroundPosition:'-200% 0%'},{backgroundPosition:'-100% 0%', ease: SteppedEase.config(1)}, 5.7)
          .set("#escena_03 .rataNegraSnorkel07Esc03", {opacity:0, immediateRender:false}, 6.9)
          .set("#escena_03 .rataNegraSplash07Esc03", {opacity:1, immediateRender:false}, 6.9)
          .addCallback(function(){
            Player.playSoundFX('chapuzon_de_ratas');
            Player.cambiaVolume('chapuzon_de_ratas', 0.5);    
          },6.9)
          .to("#escena_03 .rataNegraSplash07Esc03", 0.5, {scale: 1.8, opacity: 0.4}, 7.1)
          .set("#escena_03 .rataNegraSplash07Esc03", {opacity:0, immediateRender:false}, 7.6)
          .set("#escena_03 .rataNegraMuerte07Esc03", {opacity:1, immediateRender:false}, 7.6)
          .to("#escena_03 .rataNegraMuerte07Esc03", 6,{ bezier:{curviness:0.3, values:[{x:560,y:-380}], autoRotate:false}, ease:Linear.easeNone}, 7.6)
          
          ANIM.anim_interact_flautistaTocandoRatas
          .addLabel('final')
        ANIM.anim_interact_flautistaTocandoRatas.pause();
        
        /********ESCENA 04 *********/
        ANIM.anim_interact_alcaldeMalo = new TimelineMax(); // creo la interacción
        ANIM.anim_interact_alcaldeMalo
            .addLabel('inicio')
            .addCallback(function(){
              Player.playSoundFX('alcalde_codicioso');
              Player.cambiaVolume('alcalde_codicioso', 0.5); 
            },0)

            .addCallback(function(){
              Player.playSoundFX('amigos_codiciosos');
              Player.cambiaVolume('amigos_codiciosos', 1.0); 
            },1.0)
            
            .addCallback(function(){
              Player.playSoundFX('flautista_desilucionado');
              Player.cambiaVolume('flautista_desilucionado', 0.5); 
            },2.5)

            .to("#escena_04 .nube1",13,{x:1400,yoyo:true, duration: 1.5},0)
            .to("#escena_04 .nube2",13,{x:-1400,yoyo:true, duration: 1.5},0)
            .to("#escena_04 .rayosDeSol",4,{opacity:0.5, scale:0.9, duration: 1.5},0)
            .from("#escena_04 .rayosDeSol",3,{ scale: 1.05, 
              duration: 1.5,
              stagger: {
                each: 0.5,
            }})

            .to("#escena_04 .alcaldeBrazoMonedas_esc05",.7,{rotation:6, y:-35,yoyo:true, ease: Power0.easeOut, repeat:14},0)
            .from("#escena_04 .alcaldeOjosEsc05",0.4,{autoAlpha:1, delay:1.0, immediateRender:false},0)
            .from("#escena_04 .alcaldeOjosEsc05",1.5,{autoAlpha:0, delay:2.0, immediateRender:false},0)
            .from("#escena_04 .alcaldeOjosEsc05",0.4,{autoAlpha:1, delay:3.0, immediateRender:false},0)
            .from("#escena_04 .alcaldeOjosEsc05",1.5,{autoAlpha:0, delay:4.0, immediateRender:false},0)
            .from("#escena_04 .alcaldeOjosEsc05",0.4,{autoAlpha:1, delay:5.0, immediateRender:false},0)
            .from("#escena_04 .alcaldeOjosEsc05",1.5,{autoAlpha:0, delay:6.0, immediateRender:false},0)
            .from("#escena_04 .alcaldeOjosEsc05",0.4,{autoAlpha:1, delay:7.0, immediateRender:false},0)
            .from("#escena_04 .alcaldeOjosEsc05",1.5,{autoAlpha:0, delay:8.0, immediateRender:false},0)
            .from("#escena_04 .alcaldeOjosEsc05",0.4,{autoAlpha:1, delay:9.0, immediateRender:false},0)
            .from("#escena_04 .alcaldeOjosEsc05",1.5,{autoAlpha:0, delay:10.0, immediateRender:false},0)
            .fromTo('#escena_04 .consejero1Esc05',.7,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:9}, 1)
            .fromTo('#escena_04 .consejero2Esc05',.7,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2),repeat:9}, 1)
            .fromTo('#escena_04 .flautistaCuerpoEsc05',2,{backgroundPosition:'200% 0%', autoAlpha:1},{backgroundPosition:'100% 0%', ease: SteppedEase.config(1),repeat:1}, 2)

            .from("#escena_04 .flautistaOjosEsc05",1.0,{autoAlpha:1, delay:1.0, immediateRender:false},0)
            .from("#escena_04 .flautistaOjosEsc05",1.5,{autoAlpha:0, delay:2.0, immediateRender:false},0)
            .from("#escena_04 .flautistaOjosEsc05",1.0,{autoAlpha:1, delay:3.0, immediateRender:false},0)
            .from("#escena_04 .flautistaOjosEsc05",1.5,{autoAlpha:0, delay:4.0, immediateRender:false},0)
            .from("#escena_04 .flautistaOjosEsc05",1.0,{autoAlpha:1, delay:5.0, immediateRender:false},0)
            .from("#escena_04 .flautistaOjosEsc05",1.5,{autoAlpha:0, delay:6.0, immediateRender:false},0)
            .from("#escena_04 .flautistaOjosEsc05",1.0,{autoAlpha:1, delay:7.0, immediateRender:false},0)
            .from("#escena_04 .flautistaOjosEsc05",1.8,{autoAlpha:0, delay:8.0, immediateRender:false},0)
            .from("#escena_04 .flautistaOjosEsc05",1.0,{autoAlpha:1, delay:9.0, immediateRender:false},0) 
            .from("#escena_04 .flautistaOjosEsc05",1.5,{autoAlpha:0, delay:10.0, immediateRender:false},0)
            .addLabel('final');    
        ANIM.anim_interact_alcaldeMalo.pause();
    
        /********ESCENA 05 *********/
        const notasMusicalesPrimerPuente = [
          "#escena_05 .nota9Esc05",
          "#escena_05 .nota8Esc05",
          "#escena_05 .nota7Esc05",
          "#escena_05 .nota6Esc05",
          "#escena_05 .nota5Esc05",
          "#escena_05 .nota4Esc05",
          "#escena_05 .nota3Esc05",
          "#escena_05 .nota2Esc05",
          "#escena_05 .nota1Esc05"
        ]

        const notasMusicalesSegundoPuente = [
          "#escena_05 .nota1Esc05B",
          "#escena_05 .nota2Esc05B",
          "#escena_05 .nota3Esc05B",
          "#escena_05 .nota4Esc05B",
          "#escena_05 .nota5Esc05B",
          "#escena_05 .nota6Esc05B",
          "#escena_05 .nota7Esc05B",
          "#escena_05 .nota8Esc05B",
          "#escena_05 .nota9Esc05B",
          "#escena_05 .nota10Esc05B",
          "#escena_05 .nota11Esc05B",
          "#escena_05 .nota12Esc05B",
          "#escena_05 .nota13Esc05B",
          "#escena_05 .nota14Esc05B",
          "#escena_05 .nota15Esc05B",
          "#escena_05 .nota16Esc05B",
          "#escena_05 .nota17Esc05B",
        ]
        ANIM.anim_interact_tropaNinios = new TimelineMax(); // creo la interacción
        ANIM.anim_interact_tropaNinios
            .addLabel('inicio')
            .addCallback(function(){
              Player.playSoundFX('niño_durmiendo_1');
              Player.cambiaVolume('niño_durmiendo_1', 0.3);    
            },3.5)
            .addCallback(function(){
              Player.playSoundFX('niña_durmiendo_2');
              Player.cambiaVolume('niña_durmiendo_2', 0.3);    
            },8.0)
            .addCallback(function(){
              Player.playSoundFX('niño_durmiendo_1');
              Player.cambiaVolume('niño_durmiendo_1', 0.3);    
            },17.8)
            .addCallback(function(){
              Player.playSoundFX('niña_durmiendo_2');
              Player.cambiaVolume('niña_durmiendo_2', 0.3);    
            },19.4)

            for(let i=0; i<notasMusicalesPrimerPuente.length;i++){
              ANIM.anim_interact_tropaNinios
                .set(notasMusicalesPrimerPuente[i], { autoAlpha:1, immediateRender: false, transformOrigin:"50% 50%"}, 1.12*i)
                .to(notasMusicalesPrimerPuente[i], 0.3, {rotation: 40, yoyo:true, transformOrigin: "center", ease: Power0.easeNone,repeat:55}, 1.12*i)
                .set(notasMusicalesPrimerPuente[i], { autoAlpha:0}, 13+(i*0.7))
            }

        ANIM.anim_interact_tropaNinios
            .fromTo('#escena_05 .flautistaEsc05',2.5,{backgroundPosition:'0% 0%'},{backgroundPosition:'300% 0%', ease: SteppedEase.config(3),repeat: 8},0)
            .to('#escena_05 .flautistaEsc05',16,{bezier: {
              type: "thru",
              values:[
                /*p1*/{ x: 0, y: 0 }, { x: 600, y: -135 }, { x: 1200, y: -320 },
                /*p2*/{ x: 1400, y: -280 }, { x: 1800, y: -145 },{ x: 3000, y: -50 }],
              autoRotate: false
            },},0)

            //NINIOS: 
            .fromTo('#escena_05 .ninio1Esc05',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'400% 0%', ease: SteppedEase.config(4),repeat: 8}, 2)
            .to('#escena_05 .ninio1Esc05',17.5,{bezier: {
              type: "thru",
              values:[
                 { x: 0, y: 0 }, { x: 700, y: -130 }, { x: 1300, y: -260 },
                 { x: 1500, y: -320 }, { x: 1900, y: -140 },{ x: 3500, y: -90 }],
              autoRotate: false
            },},2)

            .fromTo('#escena_05 .ninio2Esc05',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'400% 0%', ease: SteppedEase.config(4),repeat: 8},3.5)
            .to('#escena_05 .ninio2Esc05',17.5,{bezier: {
              type: "thru",
              values:[
                 { x: 0, y: 0 }, { x: 700, y: -130 }, { x: 1300, y: -260 },
                 { x: 1500, y: -320 }, { x: 1900, y: -140 },{ x: 3500, y: -90 }],
              autoRotate: false
            },},3.5)

            .fromTo('#escena_05 .ninio3Esc05',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'400% 0%', ease: SteppedEase.config(4),repeat: 8}, 5)
            .to('#escena_05 .ninio3Esc05',17.5,{bezier: {
              type: "thru",
              values:[
                 { x: 0, y: 0 }, { x: 700, y: -130 }, { x: 1300, y: -260 },
                 { x: 1500, y: -320 }, { x: 1900, y: -140 },{ x: 3500, y: -90 }],
              autoRotate: false
            },}, 5)

            .fromTo('#escena_05 .ninio4Esc05',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'400% 0%', ease: SteppedEase.config(4),repeat: 8}, 6.5)
            .to('#escena_05 .ninio4Esc05',17.5,{bezier: {
              type: "thru",
              values:[
                 { x: 0, y: 0 }, { x: 700, y: -130 }, { x: 1300, y: -260 },
                 { x: 1500, y: -320 }, { x: 1900, y: -140 },{ x: 3500, y: -90 }],
              autoRotate: false
            },}, 6.5)

            .fromTo('#escena_05 .ninio5Esc05',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'400% 0%', ease: SteppedEase.config(4),repeat: 8}, 8)
            .to('#escena_05 .ninio5Esc05',17.5,{bezier: {
              type: "thru",
              values:[
                 { x: 0, y: 0 }, { x: 700, y: -130 }, { x: 1300, y: -260 },
                 { x: 1500, y: -320 }, { x: 1900, y: -140 },{ x: 3500, y: -90 }],
              autoRotate: false
            },}, 8)

            .fromTo('#escena_05 .ninio6Esc05', 1.5,{backgroundPosition:'0% 0%'},{backgroundPosition:'300% 0%', ease: SteppedEase.config(3),repeat: 8}, 11)
            .to('#escena_05 .ninio6Esc05',18,{bezier: {
              type: "thru",
              values:[
                 { x: 0, y: 0 }, { x: 700, y: -130 }, { x: 1300, y: -260 },
                 { x: 1500, y: -320 }, { x: 1900, y: -140 },{ x: 3500, y: -90 }],
              autoRotate: false
            },}, 11)

            //BLOQUE 2(SEGUNDO PUENTE)//
            for(let i=0; i<notasMusicalesSegundoPuente.length;i++){
              ANIM.anim_interact_tropaNinios
                .set(notasMusicalesSegundoPuente[i], { autoAlpha:1, immediateRender: false, transformOrigin:"50% 50%"}, 17+(i*0.75))
                .to(notasMusicalesSegundoPuente[i], 0.3, {rotation: 40, yoyo:true, transformOrigin: "center", ease: Power0.easeNone,repeat:55}, 17+(i*0.75))
                .set(notasMusicalesSegundoPuente[i], { autoAlpha:0}, 25.5+(i*0.7))
            }
              
        ANIM.anim_interact_tropaNinios
            .fromTo('#escena_05 .flautistaEsc05B',2.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'300% 0%', ease: SteppedEase.config(3),repeat:6},17)
            .to('#escena_05 .flautistaEsc05B',22,{bezier: {
              type: "thru",
              values:[
                /*p1*/{ x: 0, y: 0 }, { x: -600, y: -40 }, { x: -900, y: -130 },
                /*p2*/ { x: -1200, y: 10 }, { x: -1600, y: 30 },{ x: -2800, y: 30 } ],
                 autoRotate: false
            },},17)

            .fromTo('#escena_05 .ninio1Esc05B',2.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'400% 0%', ease: SteppedEase.config(4),repeat:6},17.8)
            .to('#escena_05 .ninio1Esc05B',22,{bezier: {
              type: "thru",
              values:[
                     { x: 0, y: 0 }, { x: -600, y: -60 }, { x: -900, y: -150 },
                     { x: -1150, y: -110 }, { x: -1200, y: -80 },{ x: -2800, y: 30 }],
                autoRotate: false
            },},17.8)

            .fromTo('#escena_05 .ninio2Esc05B',2.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'400% 0%', ease: SteppedEase.config(4),repeat:8},18.6)
            .to('#escena_05 .ninio2Esc05B',22,{bezier: {
              type: "thru",
              values:[
                     { x: 0, y: 0 }, { x: -600, y: -60 }, { x: -900, y: -150 },
                     { x: -1150, y: -110 }, { x: -1200, y: -80 },{ x: -2800, y: 25 }],
                autoRotate: false
            },},18.6)

            .fromTo('#escena_05 .ninio3Esc05B',2.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'400% 0%', ease: SteppedEase.config(4),repeat:8},19.4)
            .to('#escena_05 .ninio3Esc05B',22,{bezier: {
              type: "thru",
              values:[
                     { x: 0, y: 0 }, { x: -600, y: -60 }, { x: -900, y: -150 },
                     { x: -1150, y: -110 }, { x: -1200, y: -80 },{ x: -2800, y: 25 }],
                autoRotate: false
            },},19.4)

            .fromTo('#escena_05 .ninio4Esc05B',2.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'400% 0%', ease: SteppedEase.config(4),repeat:8},20)
            .to('#escena_05 .ninio4Esc05B',22,{bezier: {
              type: "thru",
              values:[
                     { x: 0, y: 0 }, { x: -600, y: -60 }, { x: -900, y: -150 },
                     { x: -1150, y: -110 }, { x: -1200, y: -80 },{ x: -2800, y: 25 }],
                autoRotate: false
            },},20)

            .fromTo('#escena_05 .ninio5Esc05B',2.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'400% 0%', ease: SteppedEase.config(4),repeat:8},20.6)
            .to('#escena_05 .ninio5Esc05B',22,{bezier: {
              type: "thru",
              values:[
                     { x: 0, y: 0 }, { x: -600, y: -60 }, { x: -900, y: -150 },
                     { x: -1150, y: -110 }, { x: -1200, y: -80 },{ x: -2800, y: 25 }],
                autoRotate: false
            },},20.6)

            .fromTo('#escena_05 .ninio6Esc05B',2.2,{backgroundPosition:'0% 0%'},{backgroundPosition:'400% 0%', ease: SteppedEase.config(4),repeat:8},24)
            .to('#escena_05 .ninio6Esc05B',20.5,{bezier: {
              type: "thru",
              values:[
                     { x: 0, y: 0 }, { x: -600, y: -60 }, { x: -900, y: -150 },
                     { x: -1150, y: -110 }, { x: -1200, y: -80 },{ x: -2190, y: 25 }],
                autoRotate: false
            },},24)
            .addLabel('final');
        ANIM.anim_interact_tropaNinios.pause();


        /********ESCENA 06 *********/
        var pathStringEsc06 = "M1049.28 325.535c-18.575 129.498 119.192 209.595 246.672 65.601 35.918-29.015-221.296-440.778-545.576-351.442-214.214 36.82-127.189 164.007-180.743 428.427-46.859 384.915-328.015 334.709-455.204 6.694-56.9-50.206 73.636-207.519 43.513-331.369 13.388-133.883-163.211-274.744-351.057-118.178-47.656 13.678-168.151 83.966-488.673 331.35";

        var arrayPathEsc06 = [];
        var newPathEsc06 = Snap.path.toCubic(pathStringEsc06);

        function setUpPointEsc06(segmentEsc06){
          for(var i = 0; i < segmentEsc06.length; i+=2){
            var pointEsc06 = {};
            pointEsc06.x = segmentEsc06[i];
            pointEsc06.y = segmentEsc06[i+1];
            arrayPathEsc06.push(pointEsc06);
          }
        }
        
        for(var i = 0; i < newPathEsc06.length; i++){
          var segmentEsc06 = newPathEsc06[i];
          var pointtEsc06;
          segmentEsc06.shift();
          pointtEsc06 = setUpPointEsc06(segmentEsc06);
        } 
        
        const notasMusicalesEsc06 = [
          "#escena_06 .nota1Esc06",
          "#escena_06 .nota2Esc06",
          "#escena_06 .nota3Esc06",
          "#escena_06 .nota4Esc06",
          "#escena_06 .nota5Esc06",
          "#escena_06 .nota6Esc06",
          "#escena_06 .nota7Esc06",
          "#escena_06 .nota8Esc06",
          //"#escena_06 .nota9Esc06",
          //"#escena_06 .nota10Esc06",
          //"#escena_06 .nota11Esc06",
          //"#escena_06 .nota12Esc06",
          //"#escena_06 .nota13Esc06"
          //"#escena_06 .nota14sc06",
          //"#escena_06 .nota15Esc06",
          //"#escena_06 .nota16Esc06",
          //"#escena_06 .nota17Esc06"
          //"#escena_06 .nota18Esc06",
          //"#escena_06 .nota19Esc06",
          //"#escena_06 .nota20Esc06",
          //"#escena_06 .nota21Esc06",
        ]
        
        const niniosCueva = [
          "#escena_06 .ninio1Esc06",
          "#escena_06 .ninio2Esc06",
          "#escena_06 .ninio3Esc06",
          "#escena_06 .ninio4Esc06",
          "#escena_06 .ninio5Esc06",
        ]
        ANIM.anim_interact_niniosCueva = new TimelineMax(); // creo la interacción
        
        //Curva y Animacion Notas Musicales
        for(let i=0; i<notasMusicalesEsc06.length;i++){
          ANIM.anim_interact_niniosCueva
            .set(notasMusicalesEsc06[i], { xPercent: -50, yPercent: -50, autoAlpha:1, immediateRender: false, transformOrigin:"50% 50%"}, 1.5*i)
            .to(notasMusicalesEsc06[i], 15, {bezier:{type:"cubic", values:arrayPathEsc06,  autoRotate: false},ease:Linear.easeNone}, 1.5*i)
            .to(notasMusicalesEsc06[i], 0.3, {rotation: 40, yoyo:true, transformOrigin: "center", ease: Power0.easeNone,repeat:60}, 1.5*i)
        }

        for(let i=0; i<niniosCueva.length; i++){
          ANIM.anim_interact_niniosCueva
          .set(niniosCueva[i], {autoAlpha:1, immediateRender: false}, 1.5*i)
          .to(niniosCueva[i], 5,{x:1540, y:-220, ease:Linear.easeNone}, 1.5*i)
          .fromTo(niniosCueva[i],1,{backgroundPosition:'0% 0%'},{backgroundPosition:'400% 0%', ease: SteppedEase.config(4), repeat: 5}, 1.5*i)
          .addCallback(function(){
            Player.playSoundFX('cueva_magica');
            Player.cambiaVolume('cueva_magica', 0.3); 
          }, (1.5*i)+5.02)
          .to(niniosCueva[i], 0.3,{opacity: 0}, (1.5*i)+5)
        }

        ANIM.anim_interact_niniosCueva.pause();

        ANIM.anim_interact_portalCueva = new TimelineMax({repeat: 5}); // creo la interacción
        ANIM.anim_interact_portalCueva 
          .addLabel('inicio')
          .to('#escena_06 .portalEsc06 #Capa_2_0',2,{ scale: 0.8, opacity: 1, ease: Power0.easeNone }, 0)
          .to('#escena_06 .portalEsc06 #Capa_2_1',1.5,{ scale: 0.5, opacity: 1, ease: Power0.easeNone, delay: 0.5 }, 0)
          .to('#escena_06 .portalEsc06 #Capa_2_2',1.5,{ scale: 0.3, opacity: 0.5, ease: Power0.easeNone, delay: 0.5 }, 0)
          .to('#escena_06 .portalEsc06 #Capa_2_3',1.5,{ scale: 0.2, opacity: 0, ease: Power0.easeNone, delay: 0.5 }, 0)  
          .addLabel('final');
        ANIM.anim_interact_portalCueva.pause();
        
        ANIM.anim_interact_niniosCueva.pause();

        ANIM.anim_interact_flautistaCueva = new TimelineMax(); // creo la interacción
        ANIM.anim_interact_flautistaCueva 
          .addLabel('inicio')
          .addCallback(function(){
            Player.playSoundFX('cueva_magica');
            Player.cambiaVolume('cueva_magica', 0.3); 
          },0)

          .fromTo('#escena_06 .flautistaEsc06',1,{backgroundPosition:'0% 0%'},{backgroundPosition:'600% 0%', ease: SteppedEase.config(6), repeat: 11}, 0)
          .from("#escena_06 .buhoOjosEsc06",0.1,{autoAlpha:1, delay:1.0, immediateRender:false},7)
          .from("#escena_06 .buhoOjosEsc06",1.0,{autoAlpha:0, delay:2.0, immediateRender:false},7)
          .from("#escena_06 .buhoOjosEsc06",0.1,{autoAlpha:1, delay:3.0, immediateRender:false},7)
          .from("#escena_06 .buhoOjosEsc06",1.0,{autoAlpha:0, delay:4.0, immediateRender:false},7)
          .from("#escena_06 .buhoOjosEsc06",0.1,{autoAlpha:1, delay:5.0, immediateRender:false},7)
          .from("#escena_06 .buhoOjosEsc06",1.0,{autoAlpha:0, delay:6.0, immediateRender:false},7) 
          .from("#escena_06 .buhoOjosEsc06",0.1,{autoAlpha:1, delay:7.0, immediateRender:false},7)
          .from("#escena_06 .buhoOjosEsc06",1.0,{autoAlpha:0, delay:8.0, immediateRender:false},7) 

          .addCallback(function(){
            Player.playSoundFX('copia_de_buho');
            Player.cambiaVolume('copia_de_buho', 0.5); 
          },11) 
          .addLabel('final');
        ANIM.anim_interact_flautistaCueva.pause();

        /********ESCENA 07 *********/
        const abrazos1 = ['#escena_07 .abrazo4Esc07','#escena_07 .abrazo5Esc07'];

        const abrazos2 = ['#escena_07 .abrazo1Esc07','#escena_07 .abrazo3Esc07'];

         ANIM.anim_interact_reencuentro= new TimelineMax();
         ANIM.anim_interact_reencuentro
          .addLabel('inicio')
          .to("#escena_07 .nube1Esc07",12,{x:1400,yoyo:true},0)
          .to("#escena_07 .nube2Esc07",12,{x:-1400,yoyo:true},0)
          .to("#escena_07 .solRayosEsc07",4,{opacity:0.5, scale:0.9,repeat:1},0)
          .from("#escena_07 .solRayosEsc07",4,{ scale: 1.05, 
            duration: 1.5,
            stagger: {
              each: 0.5,
            }})
          .fromTo(abrazos1,1.7,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2), repeat:9}, 0)
          .fromTo(abrazos2,1.7,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2), repeat:9}, 0.4)
          .fromTo('#escena_07 .abrazo2Esc07',2,{backgroundPosition:'0% 0%'},{backgroundPosition:'200% 0%', ease: SteppedEase.config(2), repeat:7}, 0.8)          
          .addLabel('final');
         ANIM.anim_interact_reencuentro.pause();
    
        //Array de anin interacts
        ANIM.arr_interacts = [
            ANIM.anim_interact_ciudad,
            ANIM.anim_interact_ciudadFuriosa,
            ANIM.anim_interact_flautista,
            ANIM.anim_interact_flautistaTocandoRatas,
            ANIM.anim_interact_alcaldeMalo,
            ANIM.anim_interact_tropaNinios,
            ANIM.anim_interact_tropaNinios2,
            ANIM.anim_interact_niniosCueva,
            ANIM.anim_interact_portalCueva,
            ANIM.anim_interact_flautistaCueva,
            ANIM.anim_interact_reencuentro,
        ];

      
        ANIM.setIniciales();
        },
    
        pausaInteractividad: () => {
        ANIM.arr_interacts.map((anim) => {
            anim.pause();
            anim.eventCallback('onComplete', null); //<--- para matar los eventos de onComplete para evitar que muestren los botones en otra escenas
        });
    
        ANIM.setIniciales();
        },
        setIniciales:() => {
            ANIM.pauseWaitSound();
            ANIM.pauseAnimaciones();
            $('.indicador_interactividad').css({'display':'none'});
            
        },
        displayInteract: (cualEscena) => {
        $(cualEscena + ' .interact').css({ display: 'block' });
        },
    
        interactividad: (
        nEscena,
        callback = undefined,
        btn_especifico = 'primario'
        ) => {
        let i_st = nEscena > 9 ? nEscena : `0${nEscena}`;
    
        //        console.log(i_st);
    
        var btn = $('#escena_' + i_st + ' .btn_interact.' + btn_especifico);
        var cb = callback;
        btn.css({ display: 'block' });
        TweenMax.fromTo(btn, 1, { alpha: 0 }, { alpha: 1 });
        let muestralo = (div, cbb) => {
            if (cbb !== undefined) {
            cbb();
            }
            div.css({ display: 'block' });
        };
        switch (nEscena) {
            case 0:
            if (btn.hasClass('primario')) {
                btn.click(function () {
                $(this).css({ display: 'none' });
                ANIM.anim_interact_ciudad.eventCallback('onComplete', muestralo, [
                    $(this),
                    cb,
                ]);
                ANIM.anim_interact_ciudad.play(0);
                });
            }
            break;
    
            case 1:
            if (btn.hasClass('primario')) {
                btn.click(function () {
                $(this).css({ display: 'none' });
                ANIM.anim_interact_ciudadFuriosa.eventCallback(
                    'onComplete',
                    muestralo,
                    [$(this), cb]
                );
                ANIM.anim_interact_ciudadFuriosa.play(0);
                });
            }
            break;
    
            case 2:
            if (btn.hasClass('primario')) {
                btn.click(function () {
                $(this).css({ display: 'none' });
                ANIM.anim_interact_flautista.eventCallback('onComplete', muestralo, [
                    $(this),
                    cb,
                ]);
                ANIM.anim_interact_flautista.play(0);
                });
            }
    
            break;
    
            case 3:
                if(btn.hasClass('primario')){
                    btn.click(function(){
                        $(this).css({"display":"none"});
                        ANIM.anim_interact_flautistaTocandoRatas.eventCallback("onComplete", muestralo, [$(this), cb]);   
                        ANIM.anim_interact_flautistaTocandoRatas.play(0);
                    });
                }
            break;
    
            case 4:
            if (btn.hasClass('primario')) {
                btn.click(function () {
                $(this).css({ display: 'none' });
                ANIM.anim_interact_alcaldeMalo.eventCallback('onComplete', muestralo, [
                    $(this),
                    cb,
                ]);
                ANIM.anim_interact_alcaldeMalo.play(0);
                });
            }
    
            break;
    
            case 5:
            if (btn.hasClass('primario')) {
                btn.click(function () {
                $(this).css({ display: 'none' });
                ANIM.anim_interact_tropaNinios.eventCallback('onComplete', muestralo, [
                    $(this),
                    cb,
                ]);
                ANIM.anim_interact_tropaNinios.play(0);
                });
            }
    
            if (btn.hasClass('primario')) {
                btn.click(function () {
                $(this).css({ display: 'none' });
                ANIM.anim_interact_tropaNinios2.eventCallback('onComplete', muestralo, [
                    $(this),
                    cb,
                ]);
                ANIM.anim_interact_tropaNinios2.play(0);
                });
            }
    
            break;

            case 6:
            if (btn.hasClass('primario')) {
                btn.click(function () {
                $(this).css({ display: 'none' });
                ANIM.anim_interact_niniosCueva.eventCallback('onComplete', muestralo, [
                    $(this),
                    cb,
                ]);
                ANIM.anim_interact_niniosCueva.play(0);
                });
            }  
            if (btn.hasClass('primario')) {
              btn.click(function () {
              $(this).css({ display: 'none' });
              ANIM.anim_interact_portalCueva.eventCallback('onComplete', muestralo, [
                  $(this),
                  cb,
              ]);
              ANIM.anim_interact_portalCueva.play(0);
              });
            }  
            if (btn.hasClass('primario')) {
              btn.click(function () {
              $(this).css({ display: 'none' });
              ANIM.anim_interact_flautistaCueva.eventCallback('onComplete', muestralo, [
                  $(this),
                  cb,
              ]);
              ANIM.anim_interact_flautistaCueva.play(0);
              });
            }  
            break;

            case 7:
              if (btn.hasClass('primario')) {
                  btn.click(function () {
                  $(this).css({ display: 'none' });
                  ANIM.anim_interact_reencuentro.eventCallback('onComplete', muestralo, [
                      $(this),
                      cb,
                  ]);
                  ANIM.anim_interact_reencuentro.play(0);
                  });
              }  
              break;
        }
        },
        compensaEscenas: (d) => {
        // ESTA FUNCIÓN HAY QUE CONFIGURARLA A MANO POR CADA ESCENA QUE LO NECESITE
        // (EN ESTE CASO LA ILUSTRACIÓN SE PERDÍA POR ARRIBA, POR ESO ESE COMPENSA POR TOP,
        // SI FUESE AL REVÉS COMPENSARÍA POR BOTTOM)
        let dif = Math.abs(d);
        //        $('#escena_00').css({'bottom':dif+'px'});
        //        $('#escena_01').css({'top':dif+'px'});
        //        $('#escena_02').css({'bottom':dif+'px'});
        //        $('#escena_03').css({'bottom':dif+'px'});
        //        $('#escena_04').css({'bottom':dif+'px'});
        //        $('#escena_05').css({'bottom':dif+'px'});
        //        $('#escena_07').css({'bottom':dif+'px'});
        //        $('#escena_08').css({'bottom':dif+'px'});
        //        $('#escena_09').css({'bottom':dif+'px'});
        //        $('#escena_10').css({'bottom':dif+'px'});
        },
        /*↑↑↑↑ HASTA LA ANTERIOR ↑↑↑↑↑*/
    };
    

    